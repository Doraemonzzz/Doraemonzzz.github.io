<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CS229 老版作业3 | Doraemonzzz</title><meta name="keywords" content="CS229"><meta name="author" content="Doraemonzzz"><meta name="copyright" content="Doraemonzzz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="课程视频地址：http:&#x2F;&#x2F;open.163.com&#x2F;special&#x2F;opencourse&#x2F;machinelearning.html 课程主页：http:&#x2F;&#x2F;cs229.stanford.edu&#x2F; 更具体的资料链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;0a6ef31ff77a 作业地址：https:&#x2F;&#x2F;github.com&#x2F;Doraemonzzz&#x2F;CS229 参考资料：https:">
<meta property="og:type" content="article">
<meta property="og:title" content="CS229 老版作业3">
<meta property="og:url" content="http://www.doraemonzzz.com/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/index.html">
<meta property="og:site_name" content="Doraemonzzz">
<meta property="og:description" content="课程视频地址：http:&#x2F;&#x2F;open.163.com&#x2F;special&#x2F;opencourse&#x2F;machinelearning.html 课程主页：http:&#x2F;&#x2F;cs229.stanford.edu&#x2F; 更具体的资料链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;0a6ef31ff77a 作业地址：https:&#x2F;&#x2F;github.com&#x2F;Doraemonzzz&#x2F;CS229 参考资料：https:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2019-03-14T10:45:00.000Z">
<meta property="article:modified_time" content="2019-10-12T09:06:58.790Z">
<meta property="article:author" content="Doraemonzzz">
<meta property="article:tag" content="CS229">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true"><link rel="canonical" href="http://www.doraemonzzz.com/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f00f37f957f0608abb8c571105456f0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-G-RE4B1LKRZD"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-G-RE4B1LKRZD');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"距离上次更新已经","messageNext":"天了，文章内容可能已经过时。"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CS229 老版作业3',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2019-10-12 17:06:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/bilibili.css" media="defer" onload="this.media='all'"><meta name="google-site-verification" content="c4v-NmuUZRgl3cvtg9GKswryK1YLaPztd_5M-df5VNI" /><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Doraemonzzz" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">711</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Doraemonzzz</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CS229 老版作业3</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-03-14T10:45:00.000Z" title="发表于 2019-03-14 18:45:00">2019-03-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2019-10-12T09:06:58.790Z" title="更新于 2019-10-12 17:06:58">2019-10-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CS229/">CS229</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>15分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/" data-flag-title="CS229 老版作业3"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>课程视频地址：<a target="_blank" rel="noopener" href="http://open.163.com/special/opencourse/machinelearning.html">http://open.163.com/special/opencourse/machinelearning.html</a></p>
<p>课程主页：<a target="_blank" rel="noopener" href="http://cs229.stanford.edu/">http://cs229.stanford.edu/</a></p>
<p>更具体的资料链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0a6ef31ff77a">https://www.jianshu.com/p/0a6ef31ff77a</a></p>
<p>作业地址：<a target="_blank" rel="noopener" href="https://github.com/Doraemonzzz/CS229">https://github.com/Doraemonzzz/CS229</a></p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://github.com/zyxue/stanford-cs229">https://github.com/zyxue/stanford-cs229</a></p>
<p>这部分回顾老版作业3。</p>
<span id="more"></span>
<h4 id="1-Uniform-convergence-and-Model-Selection"><a href="#1-Uniform-convergence-and-Model-Selection" class="headerlink" title="1. Uniform convergence and Model Selection"></a>1. Uniform convergence and Model Selection</h4><p>(a)由Hoeffding不等式，我们可得对每个$\hat h_i $，</p>
<script type="math/tex; mode=display">
P(|\epsilon(\hat h_i)-\hat \epsilon_{S_{\text{cv}}}(\hat h_i)|>\gamma )
\le 2 k e^{-2\gamma ^2 \beta m} \\
P(|\epsilon(\hat h_i)-\hat \epsilon_{S_{\text{cv}}}(\hat h_i)|\le \gamma )
\ge 1- 2 k e^{-2\gamma ^2 \beta m}</script><p>令</p>
<script type="math/tex; mode=display">
2 k e^{-2\gamma ^2 \beta m} =\frac \delta 2</script><p>可得</p>
<script type="math/tex; mode=display">
e^{2\gamma ^2 \beta m} =\frac{4k} \delta \\
 2\gamma ^2 \beta m =\log \frac{4k} \delta\\
 \gamma = \sqrt{\frac 1{2\beta m} \log \frac{4k} \delta}</script><p>因此至少有$1-\frac \delta 2$的概率，对每个$\hat h_i$，我们有</p>
<script type="math/tex; mode=display">
|\epsilon(\hat h_i)-\hat \epsilon_{S_{\text{scv}}}(\hat h_i)|
\le \sqrt{\frac 1{2\beta m} \log \frac{4k} \delta}</script><p>(b)由(a)可得，$\forall i $</p>
<script type="math/tex; mode=display">
\begin{eqnarray*}
\epsilon(\hat h_i)
&&\le \hat \epsilon_{S_{\text{scv}}}(\hat h_i)+
\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta}  \tag 1\\
\hat \epsilon_{S_{\text{scv}}}(\hat h_i)&& \le \epsilon(\hat h_i)+\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta} \tag 2
 \end{eqnarray*}</script><p>由不等式(2)可得，$\forall i $</p>
<script type="math/tex; mode=display">
\begin{eqnarray*}
\hat \epsilon_{S_{\text{scv}}}(\hat h)
&&= \min_{h\in \{\hat h_1,...,\hat h_k\}} \hat \epsilon_{S_{\text{scv}}}(h) \\
&&\le \hat \epsilon_{S_{\text{scv}}}(\hat h_i) \\
&&\le  \epsilon(\hat h_i)+\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta} \tag 3
\end{eqnarray*}</script><p>所以，$\forall i  $</p>
<script type="math/tex; mode=display">
\begin{aligned}
\epsilon(\hat  h) 
&\le \hat \epsilon_{S_{\text{scv}}}(\hat h)+
\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta} \\
&\le  \epsilon(\hat h_i)+\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta} 
+\sqrt{\frac 1{2\beta m} \log \frac{4k} \delta}\\
&\le \epsilon(\hat h_i)+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}
\end{aligned}</script><p>因此</p>
<script type="math/tex; mode=display">
\begin{aligned}
\epsilon(\hat  h) 
\le \min_{i=1,...,k}\epsilon(\hat h_i)+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}
\end{aligned}</script><p>(c)由(b)可知，</p>
<script type="math/tex; mode=display">
\begin{aligned}
\epsilon(\hat  h) 
\le \epsilon(\hat h_j)+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}
\end{aligned}</script><p>记上述事件为$A$，记如下事件为$B$</p>
<script type="math/tex; mode=display">
|\epsilon(\hat h_j) -\hat \epsilon_{S_{\text{train}}}(h_j^*)| \le 
\sqrt{\frac 2{(1-\beta) m} \log \frac{4|\mathcal H_j|} \delta},
\forall j \in \mathcal H_j</script><p>因为</p>
<script type="math/tex; mode=display">
P(A)\ge 1-\frac \delta 2 ,P(B) \ge 1-\frac \delta 2</script><p>所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(AB) &=P(A)+P(B)- P(A\cup B)\\
&\ge 1-\frac \delta 2 +1-\frac \delta 2  -1 \\
&= 1-\delta
\end{aligned}</script><p>注意$AB$即为如下事件</p>
<script type="math/tex; mode=display">
\epsilon(\hat h)
\le \epsilon(\hat h_j)+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}\le \Big( \hat \epsilon_{S_{\text{train}}}(h_j^*)+\sqrt{\frac 2{(1-\beta) m} \log \frac{4|\mathcal H_j|} \delta} \Big)
+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta},
\forall j \in \mathcal H_j \\
\epsilon(\hat h)
\le\min_{j=1,...,k}  \Big( \hat \epsilon_{S_{\text{train}}}(h_j^*)+\sqrt{\frac 2{(1-\beta) m} \log \frac{4|\mathcal H_j|} \delta} \Big)
+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}</script><p>因此</p>
<script type="math/tex; mode=display">
\epsilon(\hat h)
\le\min_{i=1,...,k}  \Big( \hat \epsilon_{S_{\text{train}}}(h_j^*)+\sqrt{\frac 2{(1-\beta) m} \log \frac{4|\mathcal H_j|} \delta} \Big)
+\sqrt{\frac 2{\beta m} \log \frac{4k} \delta}</script><p>发生的概率大于等于$1-\delta $</p>
<h4 id="2-VC-Dimension"><a href="#2-VC-Dimension" class="headerlink" title="2. VC Dimension"></a>2. VC Dimension</h4><p>后面都用$d$表示VC维。</p>
<p>$h(x)=1\{a&lt;x\}$的VC维是$1$，首先存在$1$个点可以shatter，其次对于任意两个点$x_1&lt;x_2$，标签$(1, 0)$无法表出，所以</p>
<script type="math/tex; mode=display">
d=1</script><p>$h(x)=1\{a&lt;x&lt;b\}$的VC维是$2$，首先存在$2$个点可以shatter（作图即可），其次对于任意三个点$x_1&lt;x_2&lt;x_3$，标签$(1, 0, 1)$无法表出，所以</p>
<script type="math/tex; mode=display">
d =2</script><p>$h(x)=1\{a\sin x &gt;0\}$的VC维是$1$，首先存在$1$个点可以shatter（作图即可），其次对于任意两个点$x_1 &lt;x_2$，我们有</p>
<script type="math/tex; mode=display">
(a\sin x_1 )(a\sin x_2) = \sin x_1 \sin x_2</script><p>所以如果</p>
<script type="math/tex; mode=display">
\sin x_1 \sin x_2>0</script><p>那么$(1, 0), (0,1)$的标签无法表出。如果</p>
<script type="math/tex; mode=display">
\sin x_1 \sin x_2\le 0</script><p>那么$(1,1)$的标签无法表出。所以</p>
<script type="math/tex; mode=display">
d= 1</script><p>$h(x)=1\{\sin(x+a) &gt;0\}$的VC维是$2$，首先$0, \frac \pi 2$可以被shatter，其次由于$\sin $函数的周期为$2\pi$，我们可以假设所有的点属于$[0,2\pi)$。在继续讨论之前，首先将模型转换，将$[0, 2\pi)$上的点映射到单位圆周上，$a$对应过原点的一条直线，直线一侧的点为$1$，另一侧为$0$。</p>
<p>现在假设存在三个点$0\le x_1 &lt; x_2 &lt; x_3&lt;2\pi $可以被shatter，那么标签$(1, 1,1)$表出，由之前讨论可知这表示$x_1,x_2,x_3$在直线的同侧，那么可以发现$(1, 0, 1)$必然无法表出，这是因为$x_1, x_3$在直线的同侧，介于两点之间的点$x_2$必然属于同侧，所以无法表出$(1,0,1)$</p>
<h4 id="3-ℓ-1-regularization-for-least-squares"><a href="#3-ℓ-1-regularization-for-least-squares" class="headerlink" title="3. $ℓ_1$ regularization for least squares"></a>3. $ℓ_1$ regularization for least squares</h4><p>(a)首先对$J(\theta)$进行化简：</p>
<script type="math/tex; mode=display">
\begin{aligned}
J(\theta)
&=\frac 1 2 (X\bar \theta +X_i \theta_i -\vec y) ^T(X\bar \theta +X_i \theta_i -\vec y)+\lambda ||\bar \theta||_1 +\lambda s_i \theta_i \\
&=\frac 1 2 (X\bar \theta-\vec y)^T (X\bar \theta-\vec y)
+\frac 12 \theta_i^TX_i^T   X_i \theta_i  +(X\bar \theta-\vec y)^T X_i \theta_i
+\lambda ||\bar \theta||_1 +\lambda s_i \theta_i\\
&=\frac 1 2 (X\bar \theta-\vec y)^T (X\bar \theta-\vec y)
+\frac 12 X_i^T   X_i \theta_i^2  +(X\bar \theta-\vec y)^T X_i \theta_i
+\lambda ||\bar \theta||_1 +\lambda s_i \theta_i
\end{aligned}</script><p>所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial J(\theta)}{\partial  \theta_i}
&=X_i^T   X_i \theta_i+(X\bar \theta-\vec y)^T X_i+ \lambda s_i
\end{aligned}</script><p>令上式为$0$可得</p>
<script type="math/tex; mode=display">
\theta_i = -\frac{(X\bar \theta-\vec y)^T X_i+ \lambda s_i}{X_i^T   X_i}</script><p>如果$s_i =1$，那么$\theta_i \ge 0$，所以我们有</p>
<script type="math/tex; mode=display">
\theta_i =\max \{-\frac{(X\bar \theta-\vec y)^T X_i+ \lambda }{X_i^T   X_i},0\}</script><p>如果$s_i= -1$，那么$\theta_i &lt;0$，所以我们有</p>
<script type="math/tex; mode=display">
\theta_i =\min \{-\frac{(X\bar \theta-\vec y)^T X_i- \lambda }{X_i^T   X_i},0\}</script><p>(b)代码实现的过程中要分别对$s_i =\pm1$讨论，根据选择产生较小$J(\theta )$对应的$\theta_i $。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">"""
Created on Sat Mar  9 14:27:42 2019

@author: qinzhen
"""</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

X <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">"x.dat"</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">"y.dat"</span><span class="token punctuation">)</span>
theta_true <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">"theta.dat"</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">l1l2</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> Lambda<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#数据维度</span>
    n<span class="token punctuation">,</span> d <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    <span class="token comment">#设置阈值</span>
    D <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span>
    <span class="token comment">#设置初始值</span>
    theta <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
    <span class="token comment">#记录上一轮迭代的theta</span>
    theta_pre <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment">#坐标下降</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token comment">#第i列</span>
            Xi <span class="token operator">=</span> X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span>
            <span class="token comment">#theta第i个元素为0</span>
            theta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token comment">#计算</span>
            temp1 <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">-</span> y
            temp2 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span> <span class="token punctuation">(</span>temp1<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Xi<span class="token punctuation">)</span> <span class="token operator">+</span> Lambda<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Xi<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Xi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            temp3 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span> <span class="token punctuation">(</span>temp1<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Xi<span class="token punctuation">)</span> <span class="token operator">-</span> Lambda<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>Xi<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Xi<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment">#情形1</span>
            theta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp2
            loss1 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Lambda <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment">#情形2</span>
            theta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp3
            loss2 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span> <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">+</span> Lambda <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span><span class="token builtin">abs</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span class="token punctuation">)</span>
            
            <span class="token comment">#根据较小的loss对应的值更新</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>loss1 <span class="token operator">&lt;</span> loss2<span class="token punctuation">)</span><span class="token punctuation">:</span>
                theta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp2
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                theta<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> temp3
        
        <span class="token comment">#计算误差</span>
        delta <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>theta <span class="token operator">-</span> theta_pre<span class="token punctuation">)</span>
        <span class="token keyword">if</span> delta <span class="token operator">&lt;</span> D<span class="token punctuation">:</span>
            <span class="token keyword">break</span>

        theta_pre <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
            
    <span class="token keyword">return</span> theta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(b)对Lambda = 1运行，得到如下结果：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">theta <span class="token operator">=</span> l1l2<span class="token punctuation">(</span>X<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>theta<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-none"><code class="language-none">[ 0.49875676  0.65610562 -0.79057895 -0.6556427  -0.89191611  0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.          0.          0.
  0.          0.          0.          0.        ]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以看到最终的$\theta$是稀疏的，所以可以用$l_1$正则化进行特征选择，保留系数不为$0$的特征。</p>
<h4 id="4-K-Means-Clustering"><a href="#4-K-Means-Clustering" class="headerlink" title="4. K-Means Clustering"></a>4. K-Means Clustering</h4><p>这里使用向量化的方法计算每个点距离聚类中心的距离，提高计算效率，介绍如下</p>
<p>假设</p>
<script type="math/tex; mode=display">
X = \left[
 \begin{matrix}
  — (x^{(1)})^T— \\
— (x^{(2)})^T— \\
\vdots\\
— (x^{(m)})^T— 
  \end{matrix}
  \right] \in \mathbb R^{m \times d}, Y =  \left[
 \begin{matrix}
  — (y^{(1)})^T— \\
— (y^{(2)})^T— \\
\vdots\\
— (y^{(n)})^T— 
  \end{matrix}
  \right] \in \mathbb R^{n \times d}</script><p>其中$x^{(i)} ,y^{(i)} \in \mathbb R^d$，现在的问题是如何高效计算矩阵$D \in \mathbb R^{m\times n}$，其中</p>
<script type="math/tex; mode=display">
D_{i,j} = ||x^{(i)} -y^{(j)} ||^2</script><p>首先对$D_{i,j}$进行处理</p>
<script type="math/tex; mode=display">
\begin{aligned}
D_{i,j} &= ||x^{(i)} -y^{(j)} ||^2 \\
&= (x^{(i)} -y^{(j)})^T (x^{(i)} -y^{(j)})\\
&=(x^{(i)})^T x^{(i)} -2(x^{(i)})^Ty^{(j)} +(y^{(j)})^T y^{(j)}
\end{aligned}</script><p>那么</p>
<script type="math/tex; mode=display">
\begin{aligned}
D &=  \left[
 \begin{matrix}
   D_{1,1} & ... & D_{1,n} \\
  ... &  ... &  ... \\
   D_{m,1} &  ... & D_{m,n} 
  \end{matrix}
  \right]  \\
  &= \left[
 \begin{matrix}
   (x^{(1)})^T x^{(1)} -2(x^{(1)})^Ty^{(1)} +(y^{(1)})^T y^{(1)} & ... & 
     (x^{(1)})^T x^{(1)} -2(x^{(1)})^Ty^{(n)} +(y^{(n)})^T y^{(n)}\\
  ... &  ... &  ... \\
   (x^{(m)})^T x^{(m)} -2(x^{(m)})^Ty^{(1)} +(y^{(1)})^T y^{(1)}  &  ... & 
    (x^{(m)})^T x^{(m)} -2(x^{(m)})^Ty^{(n)} +(y^{(n)})^T y^{(n)} 
  \end{matrix}
  \right] \\
  &= \left[
 \begin{matrix}
   (x^{(1)})^T x^{(1)} & ... & 
     (x^{(1)})^T x^{(1)} \\
  ... &  ... &  ... \\
   (x^{(m)})^T x^{(m)}  &  ... & 
    (x^{(m)})^T x^{(m)} 
  \end{matrix}
  \right] +\left[
 \begin{matrix}
   (y^{(1)})^T y^{(1)} & ... & 
     (y^{(n)})^T y^{(n)} \\
  ... &  ... &  ... \\
  (y^{(1)})^T y^{(1)} & ... & 
     (y^{(n)})^T y^{(n)}
  \end{matrix}
  \right]-
  2\left[
 \begin{matrix}
   (x^{(1)})^T y^{(1)} & ... & 
     (x^{(1)})^T y^{(n)} \\
  ... &  ... &  ... \\
  (x^{(m)})^T y^{(1)} & ... & 
     (x^{(m)})^T y^{(n)}
  \end{matrix}
  \right]\\
  &=\left[
 \begin{matrix}
   (x^{(1)})^T x^{(1)} \\
  ...  \\
   (x^{(m)})^T x^{(m)}  
  \end{matrix}
  \right]\underbrace{\left[
 \begin{matrix}
1&...&1
  \end{matrix}
  \right]}_{1\times n矩阵}  +\underbrace{\left[
 \begin{matrix}
1\\ 
\vdots \\
1
  \end{matrix}
  \right]}_{m\times 1矩阵} \left[
 \begin{matrix}
   (y^{(1)})^T y^{(1)}  &
  \ldots  &
  (y^{(n)})^T y^{(n)} 
  \end{matrix}
  \right] -2XY^T
\end{aligned}</script><p>利用numpy的广播机制上式可以简写如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#计算距离矩阵</span>
d1 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>X <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
d2 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>centroids <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>

dist <span class="token operator">=</span> d1 <span class="token operator">+</span> d2 <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>centroids<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>全部代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">"""
Created on Sat Mar  9 15:41:53 2019

@author: qinzhen
"""</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

<span class="token keyword">def</span> <span class="token function">draw_clusters</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> clusters<span class="token punctuation">,</span> centroids<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#颜色列表</span>
    c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"b"</span><span class="token punctuation">,</span> <span class="token string">"g"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"c"</span><span class="token punctuation">,</span> <span class="token string">"m"</span><span class="token punctuation">,</span> <span class="token string">"y"</span><span class="token punctuation">]</span>
    <span class="token comment">#聚类数量</span>
    d <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>clusters<span class="token punctuation">)</span>
    <span class="token comment">#画出每种聚类</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>d<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">[</span>clusters<span class="token operator">==</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> X<span class="token punctuation">[</span>clusters<span class="token operator">==</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    
    <span class="token comment">#画出中心</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>centroids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> centroids<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"black"</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">k_means</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> k<span class="token punctuation">,</span> plot<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#数据维度</span>
    n<span class="token punctuation">,</span> d <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    <span class="token comment">#聚类标签</span>
    clusters <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n<span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">)</span>
    <span class="token comment">#初始中心点</span>
    index <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">,</span> k<span class="token punctuation">)</span>
    <span class="token comment">#centroids = np.random.rand(k, d)</span>
    centroids <span class="token operator">=</span> X<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
    <span class="token comment">#记录上一轮迭代的聚类中心</span>
    centroids_pre <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>centroids<span class="token punctuation">)</span>
    <span class="token comment">#设置阈值</span>
    D <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">5</span>
    
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token comment">#计算距离矩阵</span>
        d1 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>X <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
        d2 <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>centroids <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        dist <span class="token operator">=</span> d1 <span class="token operator">+</span> d2 <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">*</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>centroids<span class="token punctuation">.</span>T<span class="token punctuation">)</span>
        
        <span class="token comment">#STEP1:找到最近的中心</span>
        clusters <span class="token operator">=</span> np<span class="token punctuation">.</span>argmin<span class="token punctuation">(</span>dist<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token comment">#STEP2:重新计算中心</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>
            centroids<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>X<span class="token punctuation">[</span>clusters<span class="token operator">==</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>
            
        <span class="token comment">#计算误差</span>
        delta <span class="token operator">=</span> np<span class="token punctuation">.</span>linalg<span class="token punctuation">.</span>norm<span class="token punctuation">(</span>centroids <span class="token operator">-</span> centroids_pre<span class="token punctuation">)</span>
        
        <span class="token comment">#判断是否作图</span>
        <span class="token keyword">if</span> plot<span class="token punctuation">:</span>
            draw_clusters<span class="token punctuation">(</span>X<span class="token punctuation">,</span> clusters<span class="token punctuation">,</span> centroids<span class="token punctuation">)</span>
        
        <span class="token keyword">if</span> delta <span class="token operator">&lt;</span> D<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        
        centroids_pre <span class="token operator">=</span> np<span class="token punctuation">.</span>copy<span class="token punctuation">(</span>centroids<span class="token punctuation">)</span>
        
X <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">"X.dat"</span><span class="token punctuation">)</span>

k_means<span class="token punctuation">(</span>X<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> plot<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/old%20version/ps3/md/output_1_0.png?raw=true" alt=""></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/old%20version/ps3/md/output_1_1.png?raw=true" alt=""></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/old%20version/ps3/md/output_1_2.png?raw=true" alt=""></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/old%20version/ps3/md/output_1_3.png?raw=true" alt=""></p>
<h4 id="5-The-Generalized-EM-algorithm"><a href="#5-The-Generalized-EM-algorithm" class="headerlink" title="5. The Generalized EM algorithm"></a>5. The Generalized EM algorithm</h4><p>(a)</p>
<script type="math/tex; mode=display">
\begin{eqnarray*}
l(\theta^{(t+1)})
&&\ge \sum_{i} \sum_{z^{(i)}}Q_i^{(t)}(z^{(i)}) \log \frac {p(x^{(i)},z^{(i)};\theta^{(t+1)})}{Q_i^{(t)}(z^{(i)})} \\
&&\ge \sum_{i} \sum_{z^{(i)}}Q_i^{(t)}(z^{(i)}) \log \frac {p(x^{(i)},z^{(i)};\theta^{(t)})}{Q_i^{(t)}(z^{(i)})}\\
&&=l(\theta^{(t)})
\end{eqnarray*}</script><p>第一个不等号成立是因为如下不等式对任意$Q_i$和$\theta$都成立</p>
<script type="math/tex; mode=display">
l(\theta)\ge \sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \log \frac {p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})}</script><p>第二个不等号成立是因为梯度上升，等号成立是由$\theta^{(t)}$的定义。</p>
<p>(b)利用定义求梯度即可</p>
<script type="math/tex; mode=display">
\begin{aligned}
\nabla_\theta \sum_{i} \log \sum_{z^{(i)}}p(x^{(i)},z^{(i)};\theta)

&=\sum_{i} \frac{\nabla_\theta \sum_{z^{(i)}} p(x^{(i)},z^{(i)};\theta)}{ \sum_{z^{(i)}}p(x^{(i)},z^{(i)};\theta)} \\
&=\sum_{i}\sum_{z^{(i)}} \frac{\nabla_\theta 
p(x^{(i)},z^{(i)};\theta)}
{ p(x^{(i)};\theta)}
\end{aligned}\\</script><p>注意到GEM中的梯度为</p>
<script type="math/tex; mode=display">
\begin{aligned}
\nabla_\theta \sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \log \frac {p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} 
&= \sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)})  \nabla_\theta  \log p(x^{(i)},z^{(i)};\theta)\\
&=\sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \frac{\nabla_\theta p(x^{(i)},z^{(i)};\theta)}{p(x^{(i)},z^{(i)};\theta)} 
\end{aligned}</script><p>注意我们选择</p>
<script type="math/tex; mode=display">
Q_i(z^{(i)}) =p(z^{(i)}|x^{(i)};\theta) = \frac{p(x^{(i)},z^{(i)};\theta)}{p(x^{(i)};\theta)}</script><p>所以GEM中的梯度为</p>
<script type="math/tex; mode=display">
\begin{aligned}
\nabla_\theta \sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \log \frac {p(x^{(i)},z^{(i)};\theta)}{Q_i(z^{(i)})} 
&=\sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \frac{\nabla_\theta p(x^{(i)},z^{(i)};\theta)}{p(x^{(i)},z^{(i)};\theta)} \\
&=\sum_{i} \sum_{z^{(i)}}Q_i(z^{(i)}) \frac{\nabla_\theta p(x^{(i)},z^{(i)};\theta)}{p(x^{(i)};\theta)Q_i(z^{(i)})} \\
&=\sum_{i}\sum_{z^{(i)}} \frac{\nabla_\theta 
p(x^{(i)},z^{(i)};\theta)}
{ p(x^{(i)};\theta)}
\end{aligned}</script><p>所以这两者等价。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Doraemonzzz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.doraemonzzz.com/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/">http://www.doraemonzzz.com/2019/03/14/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.doraemonzzz.com" target="_blank">Doraemonzzz</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CS229/">CS229</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/03/16/CS205A%20Lecture%201%20Introduction;%20numerics;%20error%20analysis/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CS205A Lecture 1 Introduction; numerics; error analysis</div></div></a></div><div class="next-post pull-right"><a href="/2019/03/14/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A3/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CS229 2017版作业3</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/03/01/CS229 2017版作业0/" title="CS229 2017版作业0"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-03-01</div><div class="title">CS229 2017版作业0</div></div></a></div><div><a href="/2019/04/02/CS229 2017版作业4/" title="CS229 2017版作业4"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-02</div><div class="title">CS229 2017版作业4</div></div></a></div><div><a href="/2018/12/12/CS229 Hoeffding不等式补充资料/" title="CS229 Hoeffding不等式补充资料"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-12</div><div class="title">CS229 Hoeffding不等式补充资料</div></div></a></div><div><a href="/2019/02/01/CS229 Lesson 1 机器学习的动机与应用/" title="CS229 Lesson 1 机器学习的动机与应用"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-02-01</div><div class="title">CS229 Lesson 1 机器学习的动机与应用</div></div></a></div><div><a href="/2018/12/25/CS229 Lesson 11 贝叶斯统计正则化/" title="CS229 Lesson 11 贝叶斯统计正则化"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-25</div><div class="title">CS229 Lesson 11 贝叶斯统计正则化</div></div></a></div><div><a href="/2018/12/16/CS229 Lesson 10 特征选择/" title="CS229 Lesson 10 特征选择"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-16</div><div class="title">CS229 Lesson 10 特征选择</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Livere</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNDcxOS8xMTI1Ng=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Doraemonzzz</div><div class="author-info__description">个人博客，主要记录有关机器学习，数学以及计算机科学的笔记</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">711</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">73</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">29</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Doraemonzzz"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Doraemonzzz" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/doraemon_zzz@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/291079982" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">暂无公告</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Uniform-convergence-and-Model-Selection"><span class="toc-number">1.</span> <span class="toc-text">1. Uniform convergence and Model Selection</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-VC-Dimension"><span class="toc-number">2.</span> <span class="toc-text">2. VC Dimension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E2%84%93-1-regularization-for-least-squares"><span class="toc-number">3.</span> <span class="toc-text">3. $ℓ_1$ regularization for least squares</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-K-Means-Clustering"><span class="toc-number">4.</span> <span class="toc-text">4. K-Means Clustering</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-The-Generalized-EM-algorithm"><span class="toc-number">5.</span> <span class="toc-text">5. The Generalized EM algorithm</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/03/15/2022-3-15-OSTEP-Chapter-7-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 7 回顾"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSTEP Chapter 7 回顾"/></a><div class="content"><a class="title" href="/2022/03/15/2022-3-15-OSTEP-Chapter-7-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 7 回顾">OSTEP Chapter 7 回顾</a><time datetime="2022-03-15T13:40:00.000Z" title="发表于 2022-03-15 21:40:00">2022-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/15/2022-3-15-OSTEP-Chapter-6-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 6 回顾"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSTEP Chapter 6 回顾"/></a><div class="content"><a class="title" href="/2022/03/15/2022-3-15-OSTEP-Chapter-6-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 6 回顾">OSTEP Chapter 6 回顾</a><time datetime="2022-03-15T13:38:00.000Z" title="发表于 2022-03-15 21:38:00">2022-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/15/2022-3-15-OSTEP-Chapter-5-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 5 回顾"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSTEP Chapter 5 回顾"/></a><div class="content"><a class="title" href="/2022/03/15/2022-3-15-OSTEP-Chapter-5-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 5 回顾">OSTEP Chapter 5 回顾</a><time datetime="2022-03-15T13:37:00.000Z" title="发表于 2022-03-15 21:37:00">2022-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/15/2022-3-15-OSTEP-Chapter-4-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 4 回顾"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OSTEP Chapter 4 回顾"/></a><div class="content"><a class="title" href="/2022/03/15/2022-3-15-OSTEP-Chapter-4-%E5%9B%9E%E9%A1%BE/" title="OSTEP Chapter 4 回顾">OSTEP Chapter 4 回顾</a><time datetime="2022-03-15T13:31:00.000Z" title="发表于 2022-03-15 21:31:00">2022-03-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/03/13/2022-3-13-Programming-Languages-Part-A-Section4-%E7%BF%BB%E8%AF%91/" title="Programming Languages Part A Section4 翻译"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Programming Languages Part A Section4 翻译"/></a><div class="content"><a class="title" href="/2022/03/13/2022-3-13-Programming-Languages-Part-A-Section4-%E7%BF%BB%E8%AF%91/" title="Programming Languages Part A Section4 翻译">Programming Languages Part A Section4 翻译</a><time datetime="2022-03-13T07:19:00.000Z" title="发表于 2022-03-13 15:19:00">2022-03-13</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2022 By Doraemonzzz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.25
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'IpnmxCW9CvYWIXbol5QXsegX-MdYXbMMI',
      appKey: 'w57DVCdbxcyB1TYYagMIMJIU',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Valine' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>