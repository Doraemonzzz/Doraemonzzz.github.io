<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>CS229 2017版作业1 | Doraemonzzz</title><meta name="keywords" content="CS229"><meta name="author" content="Doraemonzzz"><meta name="copyright" content="Doraemonzzz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="课程视频地址：http:&#x2F;&#x2F;open.163.com&#x2F;special&#x2F;opencourse&#x2F;machinelearning.html 课程主页：http:&#x2F;&#x2F;cs229.stanford.edu&#x2F; 更具体的资料链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;0a6ef31ff77a 作业地址：https:&#x2F;&#x2F;github.com&#x2F;Doraemonzzz&#x2F;CS229 参考资料：https:">
<meta property="og:type" content="article">
<meta property="og:title" content="CS229 2017版作业1">
<meta property="og:url" content="http://www.doraemonzzz.com/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/index.html">
<meta property="og:site_name" content="Doraemonzzz">
<meta property="og:description" content="课程视频地址：http:&#x2F;&#x2F;open.163.com&#x2F;special&#x2F;opencourse&#x2F;machinelearning.html 课程主页：http:&#x2F;&#x2F;cs229.stanford.edu&#x2F; 更具体的资料链接：https:&#x2F;&#x2F;www.jianshu.com&#x2F;p&#x2F;0a6ef31ff77a 作业地址：https:&#x2F;&#x2F;github.com&#x2F;Doraemonzzz&#x2F;CS229 参考资料：https:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2019-03-01T09:54:00.000Z">
<meta property="article:modified_time" content="2019-03-01T10:02:32.479Z">
<meta property="article:author" content="Doraemonzzz">
<meta property="article:tag" content="CS229">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true"><link rel="canonical" href="http://www.doraemonzzz.com/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f00f37f957f0608abb8c571105456f0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-G-RE4B1LKRZD"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-G-RE4B1LKRZD');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"距离上次更新已经","messageNext":"天了，文章内容可能已经过时。"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CS229 2017版作业1',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2019-03-01 18:02:32'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/bilibili.css" media="defer" onload="this.media='all'"><meta name="google-site-verification" content="c4v-NmuUZRgl3cvtg9GKswryK1YLaPztd_5M-df5VNI" /><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Doraemonzzz" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">744</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">75</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Doraemonzzz</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CS229 2017版作业1</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-03-01T09:54:00.000Z" title="发表于 2019-03-01 17:54:00">2019-03-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2019-03-01T10:02:32.479Z" title="更新于 2019-03-01 18:02:32">2019-03-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">机器学习</a></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CS229/">CS229</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>27分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/" data-flag-title="CS229 2017版作业1"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>课程视频地址：<a target="_blank" rel="noopener" href="http://open.163.com/special/opencourse/machinelearning.html">http://open.163.com/special/opencourse/machinelearning.html</a></p>
<p>课程主页：<a target="_blank" rel="noopener" href="http://cs229.stanford.edu/">http://cs229.stanford.edu/</a></p>
<p>更具体的资料链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0a6ef31ff77a">https://www.jianshu.com/p/0a6ef31ff77a</a></p>
<p>作业地址：<a target="_blank" rel="noopener" href="https://github.com/Doraemonzzz/CS229">https://github.com/Doraemonzzz/CS229</a></p>
<p>参考资料：<a target="_blank" rel="noopener" href="https://github.com/zyxue/stanford-cs229">https://github.com/zyxue/stanford-cs229</a></p>
<p>这部分回顾2017版作业1。</p>
<span id="more"></span>
<h4 id="1-Logistic-regression"><a href="#1-Logistic-regression" class="headerlink" title="1.Logistic regression"></a>1.Logistic regression</h4><p>(a)首先回顾$J(\theta)$的定义</p>
<script type="math/tex; mode=display">
J(\theta) =-\frac 1 m \sum_{i=1}^m \log (h_{\theta}(y^{(i)}x^{(i)}))\\
y(i) ∈\{−1, 1\}, h_θ(x) = g(θ^T x) ,g(z) = 1/(1 + e^{−z})</script><p>注意$g^{‘}(z) = g(z)(1-g(z))$，利用这点来求$\frac{\partial h_θ(x) }{\partial \theta_k}$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial h_θ(x) }{\partial \theta_k}
&=\frac{\partial g(θ^T x) }{\partial \theta_k}\\
&= g(θ^T x) (1-g(θ^T x) )  \frac{\partial (θ^T x) }{\partial \theta_k} \\
&= g(θ^T x) (1-g(θ^T x) )  x_k\\
&=h_θ(x)(1-h_θ(x))x_k
\end{aligned}</script><p>利用$\frac{\partial h_θ(x) }{\partial \theta_k}$来求$\frac{\partial J(\theta)}{\partial \theta_k}$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial J(\theta)}{\partial \theta_k}
&= -\frac 1 m \sum_{i=1}^m \frac{\partial \log (h_{\theta}(y^{(i)}x^{(i)}))}{\partial \theta_k} \\
&= -\frac 1 m \sum_{i=1}^m \frac 1 {h_{\theta}(y^{(i)}x^{(i)}))} \frac{\partial h_{\theta}(y^{(i)}x^{(i)}))}{\partial \theta_k} \\
&= -\frac 1 m \sum_{i=1}^m \frac 1 {h_{\theta}(y^{(i)}x^{(i)}))}  h_θ(y^{(i)}x^{(i)})(1-h_θ(y^{(i)}x^{(i)}))y^{(i)}x_k^{(i)}\\
&= -\frac 1 m \sum_{i=1}^m (1-h_θ(y^{(i)}x^{(i)}))y^{(i)}x_k^{(i)}
\end{aligned}</script><p>这个形式方便我们求二阶偏导，继续利用$\frac{\partial h_θ(x) }{\partial \theta_k}$来求$\frac{\partial^2 J(\theta)}{\partial \theta_l\partial \theta_k}$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial^2 J(\theta)}{\partial \theta_l\partial \theta_k}
&= -\frac 1 m \sum_{i=1}^m y^{(i)}x_k^{(i)}\frac {\partial {(1-h_θ(y^{(i)}x^{(i)}))}}{\partial \theta_l}\\
&=\frac 1 m \sum_{i=1}^m y^{(i)}x_k^{(i)} \frac {\partial {(h_θ(y^{(i)}x^{(i)}))}}{\partial \theta_l}\\
&=\frac 1 m  \sum_{i=1}^mx_k^{(i)} h_θ(y^{(i)}x^{(i)})(1-h_θ(y^{(i)}x^{(i)})) x_l^{(i)}
\end{aligned}</script><p>接着作以下记号</p>
<script type="math/tex; mode=display">
x_k=[x_1^{(k)},...,x_n^{(k)}]^T \in \mathbb R^n\\
  X=  \left[
 \begin{matrix}
 x_1^T\\
  ...\\
x_m^T 
  \end{matrix}
  \right] \in \mathbb R^{m\times n} \\
  \Lambda= \text {diag} \{h_θ(y^{(1}x^{(1)})(1-h_θ(y^{(1)}x^{(1)}),...,h_θ(y^{(m)}x^{(m)})(1-h_θ(y^{(m)}x^{(m)})\} \in\mathbb R^{m\times m}</script><p>所以Hessian矩阵$H$可以表达为如下形式</p>
<script type="math/tex; mode=display">
H= X^T \Lambda X</script><p>为了(b)题需要，这里也将$\nabla J(\theta)$表示出来</p>
<script type="math/tex; mode=display">
S = \left[
 \begin{matrix}
  (1-h_θ(y^{(1)}x^{(1)}))y^{(1)} \\
... \\
  (1-h_θ(y^{(m)}x^{(m)}))y^{(m)}
  \end{matrix}
  \right] \in\mathbb R^m\\
\nabla J(\theta) = -\frac 1  m X^T S</script><p>现在任取$z\in \mathbb R^n$，记$t=X^Tz$，那么</p>
<script type="math/tex; mode=display">
z^THz = z^TX \Lambda X^Tz =t^T \Lambda  t =\sum_{i=1}^m t_i^2 h_θ(y^{(i)}x^{(i)})(1-h_θ(y^{(i)}x^{(i)})</script><p>注意$h_θ(y^{(i)}x^{(i)}) \in [0,1]$，所以$h_θ(y^{(i)}x^{(i)})(1-h_θ(y^{(i)}x^{(i)}) \ge 0$，从而</p>
<script type="math/tex; mode=display">
z^THz =\sum_{i=1}^m t_i^2 h_θ(y^{(i)}x^{(i)})(1-h_θ(y^{(i)}x^{(i)}) \ge 0</script><p>从而$H$为半正定矩阵。</p>
<p>(b)(c)</p>
<p>这里解释下计算步骤，第一步是读取数据并增加一个截距项，由以下两个函数完成。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span>matplotlib inline
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token comment">#import matplotlib as mpl</span>
<span class="token comment">#mpl.use('Agg')</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv
<span class="token comment">#from __future__ import division</span>


<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'logistic_x.txt'</span><span class="token punctuation">)</span>
    Y <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'logistic_y.txt'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> X<span class="token punctuation">,</span> Y

<span class="token comment">#增加截距项</span>
<span class="token keyword">def</span> <span class="token function">add_intercept</span><span class="token punctuation">(</span>X_<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X_<span class="token punctuation">.</span>shape
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">################</span>
    ones <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ones<span class="token punctuation">,</span> X_<span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">################</span>
    <span class="token keyword">return</span> X<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>第二步是利用刚刚的公式计算梯度以及Hessian矩阵。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#利用之前所述的公式计算</span>
<span class="token keyword">def</span> <span class="token function">calc_grad</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    grad <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>theta<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

    <span class="token comment">##############</span>
    Y_ <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    d1 <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token operator">*</span>Y_<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>d1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    S <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> h<span class="token punctuation">)</span> <span class="token operator">*</span> Y
    grad <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> <span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>S<span class="token punctuation">)</span>

    <span class="token comment">##############</span>

    <span class="token keyword">return</span> grad

<span class="token keyword">def</span> <span class="token function">calc_hessian</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    H <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">##############</span>
    Y <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    d1 <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>d1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    S <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>h <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
    H <span class="token operator">=</span> X<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>S<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">)</span>

    <span class="token comment">#############</span>

    <span class="token keyword">return</span> H<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里还有两个辅助的函数，分别是计算$J(\theta)$和作图。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">calc_loss</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    loss <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">.</span>

    <span class="token comment">###########</span>
    Y <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    d1 <span class="token operator">=</span> <span class="token punctuation">(</span>X<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>
    h <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>d1<span class="token punctuation">)</span><span class="token punctuation">)</span>
    loss <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token operator">*</span> np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment">###########</span>

    <span class="token keyword">return</span> loss

<span class="token keyword">def</span> <span class="token function">plot</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#plt.figure()</span>

    <span class="token comment">############</span>
    x1 <span class="token operator">=</span> X<span class="token punctuation">[</span>Y<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    y1 <span class="token operator">=</span> X<span class="token punctuation">[</span>Y<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
    x2 <span class="token operator">=</span> X<span class="token punctuation">[</span>Y<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
    y2 <span class="token operator">=</span> X<span class="token punctuation">[</span>Y<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token comment">#计算系数</span>
    theta <span class="token operator">=</span> logistic_regression<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>
    Min <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    Max <span class="token operator">=</span> np<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>Min<span class="token punctuation">,</span> Max<span class="token punctuation">]</span><span class="token punctuation">)</span>
    y <span class="token operator">=</span> <span class="token operator">-</span><span class="token punctuation">(</span>theta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> theta<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token operator">/</span>theta<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'Newton’s method for Logistic regression'</span><span class="token punctuation">)</span>
    <span class="token comment">############</span>

    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span><span class="token string">'ps1q1c.png'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>最重要的一步就是利用如下公式迭代计算：</p>
<script type="math/tex; mode=display">
\theta = \theta - H^{-1} \nabla J(\theta)</script><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">logistic_regression</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X<span class="token punctuation">.</span>shape
    theta <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n<span class="token punctuation">)</span>

    <span class="token comment">############</span>
    H <span class="token operator">=</span> calc_hessian<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span>
    grad <span class="token operator">=</span> calc_grad<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span>
    theta <span class="token operator">-=</span> inv<span class="token punctuation">(</span>H<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>grad<span class="token punctuation">)</span>
    <span class="token comment">############</span>

    <span class="token keyword">return</span> theta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">X_<span class="token punctuation">,</span> Y <span class="token operator">=</span> load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> add_intercept<span class="token punctuation">(</span>X_<span class="token punctuation">)</span>
theta <span class="token operator">=</span> logistic_regression<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span>
plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> theta<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_8_0.png?raw=true" alt=""></p>
<p>全部代码可以查看my_logistic.py这个文件。</p>
<h4 id="2-Poisson-regression-and-the-exponential-family"><a href="#2-Poisson-regression-and-the-exponential-family" class="headerlink" title="2.Poisson regression and the exponential family"></a>2.Poisson regression and the exponential family</h4><p>(a)</p>
<script type="math/tex; mode=display">
p(y; λ) =\frac{ e^{−λ}λ^y}{y!} =\frac 1 {y!} e^{y \log \lambda-\lambda}</script><p>对比指数族的形式</p>
<script type="math/tex; mode=display">
p(y; η) = b(y) \exp(η^T T (y) − a(η))</script><p>可得</p>
<script type="math/tex; mode=display">
b(y) = \frac 1 {y!},\eta = \log \lambda,T(y)=y,a(\eta) =\lambda =e^{\eta}</script><p>所以泊松分布为指数族。</p>
<p>(b)我们来计算$g(η) = \mathbb E[T (y); η]$</p>
<script type="math/tex; mode=display">
 \mathbb E[T (y); η]= \mathbb E[y; η] =\lambda =e^{\eta}</script><p>(c)根据GLM的性质可知$\eta = \theta^T x$，那么$\lambda=e^{\eta} =e^{\theta^T x}$</p>
<p>计算对数似然函数</p>
<script type="math/tex; mode=display">
\begin{aligned}
l &= \log p(y^{(i)}|x^{(i)}; θ)\\
&= \log(\frac{ e^{−λ}λ^{y^{(i)}}}{y^{(i)}!} )\\
&=y^{(i)}\log \lambda -\lambda -\log(y^{(i)}!)\\
&=y^{(i)}\theta^T x^{(i)} -e^{\theta^T x^{(i)}} -\log(y^{(i)}!)
\end{aligned}</script><p>关于$\theta_j$求偏导可得</p>
<script type="math/tex; mode=display">
\frac{\partial l}{\partial \theta_j} =y^{(i)}x^{(i)}_j -e^{\theta^T x^{(i)}} x_j=(y^{(i)}-e^{\theta^T x^{(i)}} )x_j</script><p>此处求最大值，用随机梯度上升法，更新规则为</p>
<script type="math/tex; mode=display">
\theta_j = \theta_j+\alpha (y^{(i)}-e^{\theta^T x^{(i)}} )x_j</script><p>(d)$T(y)=y$，所以</p>
<script type="math/tex; mode=display">
p(y; η) = b(y) \exp(η^T T (y) − a(η)) = b(y) \exp(η^T y − a(η))</script><script type="math/tex; mode=display">
 \mathbb E[T (y); η]= \mathbb E[y; η]</script><script type="math/tex; mode=display">
\begin{aligned}
l &=\log p(y|X; θ)\\
&=\log \Big( b(y) \exp(η^T y − a(η) )\Big)\\
&=η^T y − a(η) +\log b(y) 
\end{aligned}</script><p>因为$\eta = \theta^Tx$，所以</p>
<script type="math/tex; mode=display">
\frac{\partial l}{\partial \theta_j} =y x_j - \frac{\partial  a(η)}{\partial η}\frac{\partial  η}{\partial \theta_j}= (y-\frac{\partial  a(η)}{\partial η})x_j</script><p>接下来只要证明$\frac{\partial  a(η)}{\partial η}= h(x) = \mathbb E[y;\eta]$即可，利用$p(y; η) $为概率密度函数</p>
<script type="math/tex; mode=display">
\int_{-\infty}^{+\infty} b(y) \exp(η^Ty − a(η)) dy =1\\
\int_{-\infty}^{+\infty} b(y) \exp(η^Ty ) dy =\exp(a(η)) \\</script><p>两边关于$\eta$求偏导可得</p>
<script type="math/tex; mode=display">
\int_{-\infty}^{+\infty}y b(y) \exp(η^T y))dy =\exp(a(η)) \frac{\partial  a(η)}{\partial η}\\
\frac{\partial  a(η)}{\partial η} =\int_{-\infty}^{+\infty} yb(y) \exp(η^Ty − a(η)) dy =\mathbb E[y;\eta]</script><p>所以</p>
<script type="math/tex; mode=display">
\frac{\partial l}{\partial \theta_j} = (y-h(x))x_j</script><p>从而梯度上升法的更新规则为</p>
<script type="math/tex; mode=display">
\theta_j = \theta_j+\alpha (y-h(x))x_j =\theta_j-\alpha (h(x)-y)x_j</script><h4 id="3-Gaussian-discriminant-analysis"><a href="#3-Gaussian-discriminant-analysis" class="headerlink" title="3.Gaussian discriminant analysis"></a>3.Gaussian discriminant analysis</h4><p>(a)先计算$P(x)$</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(x) &= P(y=1)P(x|y=1) + P(y=-1)P(x|y=-1)\\
&=\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)
\end{aligned}</script><p>利用贝叶斯公式计算$P(y|x)$，分$y=1,y=-1$计算</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(y|x)
&=\frac{P(x|y)P(y)}{P(x)}\\
&=\frac{P(x|y)P(y)}{\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}
\end{aligned}</script><p>所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(y=1|x)
&=\frac{P(x|y=1)P(y=1)}{\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}\\
&=\frac{ \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)\phi}{\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}\\
&=\frac{1}{1+\frac{1-\phi}{\phi} \text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})+\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)}
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
P(y=-1|x)
&=\frac{P(x|y=-1)P(y=-1)}{\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}\\
&=\frac{ (1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}
{\phi  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)\Big)+
(1-\phi)  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}\\
&=\frac{1}{1+\frac{\phi} {1-\phi} \text{exp} \Big (-\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)+\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}
\end{aligned}</script><p>可以看到，指数部分都有一样的式子，现在计算这个式子</p>
<script type="math/tex; mode=display">
\begin{aligned}
−\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})+\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)
&=\frac 1 2
\Big(x^T Σ^{−1}x -2\mu_1 ^T Σ^{−1}x + \mu_1 ^T Σ^{−1}  \mu_1
-x^T Σ^{−1}x+2\mu_{-1} ^T Σ^{−1}x -\mu_{-1} ^T Σ^{−1}  \mu_{-1}\Big) \\ 
&=\frac 1 2 \Big( 2(\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x + \mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} \Big)\\
&=(\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x +\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )
\end{aligned}</script><p>所以</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(y=1|x) 
&=\frac{1}{1+\frac{1-\phi}{\phi} \text{exp} \Big ((\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x +\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )\Big)}\\
&=\frac{1}{1+\text{exp} \Big ((\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x +\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )
+\text{ln}(\frac{1-\phi}{\phi}) \Big)}
\end{aligned}\\

\begin{aligned}
P(y=-1|x) 
&=\frac{1}{1+\frac{\phi} {1-\phi} \text{exp} \Big (-\frac 12(x − \mu_1)^T Σ^{−1}(x − \mu_1)+\frac 12(x − \mu_{-1})^T Σ^{−1}(x − \mu_{-1})\Big)}\\
&=\frac{1}{1+\text{exp} \Big (-(\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x -\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} ) -\text{ln}(\frac{1-\phi}{\phi})\Big)}
\end{aligned}</script><p>综合两式，$P(y|x) $可以写为</p>
<script type="math/tex; mode=display">
\begin{aligned}
P(y|x) 
&=\frac{1}{1+\text{exp} \Big (y\Big((\mu_{-1} ^T Σ^{−1}-\mu_1 ^T Σ^{−1})x +\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )
+\text{ln}(\frac{1-\phi}{\phi})\Big) \Big)}\\
&=\frac{1}{1+\text{exp} \Big (-y\Big((\mu_1 ^T Σ^{−1} -\mu_{-1} ^T Σ^{−1})x -\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )
-\text{ln}(\frac{1-\phi}{\phi})\Big) \Big)}
\end{aligned}</script><p>令</p>
<script type="math/tex; mode=display">
\theta = (\mu_1 ^T Σ^{−1} -\mu_{-1} ^T Σ^{−1})^T = Σ^{−1} (\mu_1 - \mu_{-1})\\
\theta_0 =  -\frac 1 2 (\mu_1 ^T Σ^{−1}\mu_1 -\mu_{-1} ^T Σ^{−1}  \mu_{-1} )
-\text{ln}(\frac{1-\phi}{\phi})</script><p>从而</p>
<script type="math/tex; mode=display">
p(y | x; φ, Σ, \mu_{−1}, \mu_1) = \frac{1}
{1 + \text{exp}(−y(θ^T x + θ_0))}</script><p>(b)(c)</p>
<p>(c)是(b)的一般情形，所以直接处理(c)</p>
<p>先观察$P(x|y)$的形式，可以得到如下公式</p>
<script type="math/tex; mode=display">
P(x|y) = \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_y)^T Σ^{−1}(x − \mu_y)\Big)</script><p>接着计算$\text{log}P(x,y)$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\text{log} P(x,y) 
&= \text{log}P(x|y)P(y)\\
&=\text{log}\Big(  \frac1{(2π)^{n/2}|Σ|^{1/2}  }\text{exp} \Big (−\frac 12(x − \mu_y)^T Σ^{−1}(x − \mu_y)\Big) \phi ^{ 1\{y = 1\}} (1-\phi)^{^{ 1\{y = -1\}}} \Big) \\
&= \text{log}  \frac1{(2π)^{n/2}|Σ|^{1/2}} −\frac 12(x − \mu_y)^T Σ^{−1}(x − \mu_y)  + 1\{y = 1\} \text{log} \phi + 1\{y = -1\} \log(1-\phi)
\end{aligned}</script><p>对数似然函数为</p>
<script type="math/tex; mode=display">
\begin{aligned}
ℓ(φ, \mu_{−1}, \mu_1, Σ) 
&=\text{log}\prod_{i=1}^m p(x^{(i)}, y^{(i)}; φ, \mu_{−1}, \mu_1, Σ)\\
&= \sum_{i=1}^{m}  \text{log}  p(x^{(i)}, y^{(i)}; φ, \mu_{−1}, \mu_1, Σ)\\
&= \sum_{i=1}^{m} \Big( \text{log}  \frac1{(2π)^{n/2}|Σ|^{1/2}} −\frac 12(x^{(i)} − \mu_{y^{(i)}})^T Σ^{−1}(x^{(i)} − \mu_{y^{(i)}})  + 1\{y^{(i)} = 1\} \text{log} \phi + 1\{y^{(i)} = -1\} \log(1-\phi) \Big)\\
\end{aligned}</script><p>关于$\phi$求梯度</p>
<script type="math/tex; mode=display">
\frac{\partial ℓ}{\partial \phi} = \sum_{i=1}^{m} \Big( \frac{1\{y^{(i)} = 1\}  }{\phi}- \frac{1\{y^{(i)} = -1\}}{1- \phi}\Big) = 0\\
\sum_{i=1}^{m} 1\{y^{(i)} = 1\} (1-\phi)   - 1\{y^{(i)} = -1\}  \phi  =0 \\
\sum_{i=1}^{m} 1\{y^{(i)}= 1\}  = m\phi \\
\phi = \frac{1}{m} \sum_{i=1}^{m} 1\{y^{(i)}= 1\}</script><p>关于$\mu_1,\mu_{-1}$求梯度</p>
<script type="math/tex; mode=display">
\nabla_{\mu_1} ℓ = \sum_{i=1}^{m}Σ^{−1}(x^{(i)} − \mu_{y^{(i)}})1 \{y^{(i)} = 1\} =0\\
\sum_{i=1}^{m} (x^{(i)} − \mu_1)1 \{y^{(i)} = 1\} =0\\
\mu_1= \frac{\sum_{i=1}^{m}1\{y^{(i)} = 1\}x^{(i)}  }{\sum_{i=1}^{m}1\{y^{(i)} = 1\}} \\
\nabla_{\mu_{-1}} ℓ = \sum_{i=1}^{m}Σ^{−1}(x^{(i)} − \mu_{y^{(i)}})1 \{y^{(i)} =- 1\} =0\\
\sum_{i=1}^{m} (x^{(i)} − \mu_{-1})1 \{y^{(i)} = -1\} =0\\
\mu_{-1}= \frac{\sum_{i=1}^{m}1\{y^{(i)} =- 1\}x^{(i)}  }{\sum_{i=1}^{m}1\{y^{(i)} = -1\}}</script><p>求$\Sigma$的时候利用一些技巧性，我们不求的$\Sigma$极大似然估计，而是求$\Sigma^{-1}$的极大似然估计，然后再求出$\Sigma $的极大似然估计，利用如下两个式子</p>
<script type="math/tex; mode=display">
\nabla_A \det|A| = \det|A|(A ^{-1})^T\\
\nabla_A (x^TAy) = \nabla_A  \text{trace}(x^TAy) =  xy^T</script><p>那么</p>
<script type="math/tex; mode=display">
\nabla_{\Sigma^{-1}} ℓ = \nabla_{\Sigma^{-1}} \Big( \frac m 2 \log \Big|{\Sigma}^{-1} \Big|   \Big) -  \frac 12 \nabla_{\Sigma^{-1}} \sum_{i=1}^{m} (x^{(i)} − \mu_{y^{(i)}})^T Σ^{−1}(x^{(i)} − \mu_{y^{(i)}}) = 0\\
  \frac m 2 \frac{1}{ \Big|{\Sigma}^{-1} \Big|}  \Big|{\Sigma}^{-1} \Big|{\Sigma} -\frac 1 2  \sum_{i=1}^{m}  (x^{(i)} − \mu_{y^{(i)}}) (x^{(i)} − \mu_{y^{(i)}})^T = 0\\
  \Sigma = \frac 1  m  \sum_{i=1}^{m}  (x^{(i)} − \mu_{y^{(i)}}) (x^{(i)} − \mu_{y^{(i)}})^T</script><p>所以结论成立。</p>
<h4 id="4-Linear-invariance-of-optimization-algorithms"><a href="#4-Linear-invariance-of-optimization-algorithms" class="headerlink" title="4.Linear invariance of optimization algorithms"></a>4.Linear invariance of optimization algorithms</h4><p>(a)我们计算$∇_zg(z),∇_z^2g(z)$。</p>
<p>先计算$∇_zg(z),$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial g(z)}{\partial z_i} &=\sum_{k=1}^n\frac{\partial f(Az)}{\partial (Az)_k}\frac {\partial (Az)_k}{\partial z_i}\\
&=\sum_{k=1}^n\frac{\partial f(Az)}{\partial x_k}\frac {\partial (Az)_k}{\partial z_i}\\
&=\sum_{k=1}^n\frac{\partial f(Az)}{\partial x_k}A_{ki}\\
&=(A^T)_i \nabla_x f(Az)
\end{aligned}\\
(A^T)_i表示A^T的第i行</script><p>所以</p>
<script type="math/tex; mode=display">
∇_zg(z)= A^T \nabla_x f(Az)</script><p>接着计算$∇_z^2g(z)$</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial^2 g(z)}{\partial z_j \partial z_i} 
&=\frac{\partial\Big(\sum_{k=1}^n\frac{\partial f(Az)}{\partial x_k}A_{ki}\Big)}{\partial z_j}\\
&=\sum_{k=1}^n \sum_{l=1}^n\frac{\partial^2 f(Az)}{\partial (Az)_l\partial x_k}  \frac{\partial (Az)_l}{\partial x_j}A_{ki}\\
&=\sum_{k=1}^n \sum_{l=1}^n\frac{\partial^2 f(Az)}{\partial x_l\partial x_k} A_{lj}A_{ki}
\end{aligned}</script><p>从而</p>
<script type="math/tex; mode=display">
∇_z^2g(z) = A^T  ∇_x^2f(Az) A</script><p>接着利用数学归纳法来证明结论。</p>
<p>$n=0$时，</p>
<script type="math/tex; mode=display">
z^{(0)} = A^{-1}x^{(0)} =0</script><p>所以$n=0$时结论成立。假设$n\le i$时，$z^{(n)} = A^{-1}x^{(n)}$，那么$n=i+1$时</p>
<script type="math/tex; mode=display">
\begin{aligned}
z^{(i+1)} &=z^{(i)} -  (\nabla^2_z g(z^{(i)}))^{−1}∇_zg(z)\\
&= A^{-1}x^{(i)}  - A^{-1}( ∇_x^2f(Az^{(i)}) )^{-1} (A^{T})^{-1} A^T \nabla_x f(Az^{(i)})\\
&=A^{-1}x^{(i)} - A^{-1}( ∇_x^2f(Az^{(i)}) )^{-1}  \nabla_x f(Az^{(i)})\\
&=A^{-1}(x^{(i)} - (∇_x^2f(Az^{(i)})) ^{-1}  \nabla_x f(Az^{(i)}))\\
&=A^{-1}(x^{(i)} -( ∇_x^2f(x^{(i)}) )^{-1}  \nabla_x f(x^{(i)}))\\
&=A^{-1} x^{(i+1)}
\end{aligned}</script><p>其中倒数第二步是因为$x^{(i)} = Az^{(i)}$，所以$n=i+1$时结论成立，从而牛顿法满足invariant to linear reparameterizations</p>
<p>(b)对于梯度下降法， 继续利用</p>
<script type="math/tex; mode=display">
∇_zg(z)= A^T \nabla_x f(Az)</script><p>假设$z^{(i)} = A^{-1} x^{(i)}$，那么</p>
<script type="math/tex; mode=display">
\begin{aligned}
z^{(i+1)} 
&=z^{(i)} -  \alpha∇_zg(z)\\
&=A^{-1}x^{(i)} - \alpha  A^T \nabla_x f(Az)\\
&=A^{-1}x^{(i)} - \alpha  A^T \nabla_x f(x^{(i)})
\end{aligned}\\</script><p>但是</p>
<script type="math/tex; mode=display">
x^{(i+1)} = x^{(i)}  - \alpha \nabla_x f(x^{(i)})\\
A^{-1}x^{(i+1)}= A^{-1}x^{(i)}  - \alpha A^{-1}  \nabla_x f(x^{(i)})</script><p>所以$z^{(i+1)} $与$A^{-1}x^{(i+1)}$不相等，从而梯度下降法不满足invariant to linear reparameterizations</p>
<h4 id="5-Regression-for-denoising-quasar-spectra"><a href="#5-Regression-for-denoising-quasar-spectra" class="headerlink" title="5.Regression for denoising quasar spectra"></a>5.Regression for denoising quasar spectra</h4><p>(a)</p>
<p>(i)</p>
<script type="math/tex; mode=display">
J(θ) = \frac 1 2 \sum_{i=1}^m w^{(i)} \Big(θ^T x^{(i)} − y^{(i)}\Big)^2</script><p>记</p>
<script type="math/tex; mode=display">
X = [x^{(1)},...,x^{(m)}]^T\\
y = [y^{(1)},...,y^{(m)}]^T\\
W=\frac 1 2 \text{diag}\{w^{(1)},...,w^{(m)} \}</script><p>那么</p>
<script type="math/tex; mode=display">
J(θ) = (Xθ − y)^T W (Xθ − y)</script><p>(ii)</p>
<script type="math/tex; mode=display">
\begin{aligned}
J(θ) 
&= (Xθ − y)^T W (Xθ − y)\\
&= \theta^T X^T WX \theta - 2y^TW^TX\theta +y^Ty
\end{aligned}\\
\nabla J(\theta)= 2  X^T WX \theta - 2X^TWy =0\\
\theta =( X^T WX )^{-1} X^TWy</script><p>(iii)</p>
<script type="math/tex; mode=display">
p(y^{(i)}|x^{(i)}; θ) = \frac 1 {\sqrt {2π}σ^{ (i)}} \text{exp}\Big(−\frac{(y^{(i)} −θ^T x^{(i)})^2}{2(σ^{(i)})^2}\Big)^2</script><p>似然函数为</p>
<script type="math/tex; mode=display">
\prod_{i=1}^m \frac 1 {\sqrt {2π}σ^{ (i)}} \text{exp}\Big(−\frac{(y^{(i)} −θ^T x^{(i)})^2}{2(σ^{(i)})^2}\Big)^2
=\Big(\prod_{i=1}^m \frac 1 {\sqrt {2π}σ^{ (i)}}\Big) \text{exp}\Big(−\sum_{i=1}^m\frac{(y^{(i)} −θ^T x^{(i)})^2}{2(σ^{(i)})^2}\Big)^2</script><p>对于固定的$\sigma^{(i)}$，最大化这个概率似然函数等价于最小化</p>
<script type="math/tex; mode=display">
\frac 1 2 \sum_{i=1}^m\frac{(y^{(i)} −θ^T x^{(i)})^2}{(σ^{(i)})^2}</script><p>记$w^{(i)}=\frac 1 { {(σ^{(i)})^2}}$，这个式子可以转化为</p>
<script type="math/tex; mode=display">
\frac 1 2 \sum_{i=1}^m w^{(i)}{(y^{(i)} −θ^T x^{(i)})^2}</script><p>(b)</p>
<p>(i)</p>
<p>第一步还是读取数据以及增加截距。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span>matplotlib inline
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token comment">#import matplotlib as mpl</span>
<span class="token comment">#mpl.use('Agg')</span>
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">from</span> numpy<span class="token punctuation">.</span>linalg <span class="token keyword">import</span> inv

<span class="token keyword">def</span> <span class="token function">load_data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    train <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'quasar_train.csv'</span><span class="token punctuation">,</span> skip_header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
    test <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'quasar_test.csv'</span><span class="token punctuation">,</span> skip_header<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span>
    wavelengths <span class="token operator">=</span> np<span class="token punctuation">.</span>genfromtxt<span class="token punctuation">(</span><span class="token string">'quasar_train.csv'</span><span class="token punctuation">,</span> skip_header<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> delimiter<span class="token operator">=</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> train<span class="token punctuation">,</span> test<span class="token punctuation">,</span> wavelengths

<span class="token keyword">def</span> <span class="token function">add_intercept</span><span class="token punctuation">(</span>X_<span class="token punctuation">)</span><span class="token punctuation">:</span>
    X <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token comment">#####################</span>
    X_ <span class="token operator">=</span> X_<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> X_<span class="token punctuation">.</span>shape
    ones <span class="token operator">=</span> np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    X <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ones<span class="token punctuation">,</span> X_<span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment">###################</span>
    <span class="token keyword">return</span> X<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这一部分直接利用最小二乘法计算结果。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#利用最小二乘公式</span>
<span class="token keyword">def</span> <span class="token function">LR_smooth</span><span class="token punctuation">(</span>Y<span class="token punctuation">,</span> X_<span class="token punctuation">)</span><span class="token punctuation">:</span>
    X <span class="token operator">=</span> add_intercept<span class="token punctuation">(</span>X_<span class="token punctuation">)</span>
    Y <span class="token operator">=</span> Y<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    yhat <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>Y<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>
    theta <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token comment">#####################</span>
    theta <span class="token operator">=</span> inv<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>
    yhat <span class="token operator">=</span> X<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>theta<span class="token punctuation">)</span>

    <span class="token comment">#####################</span>
    <span class="token keyword">return</span> yhat<span class="token punctuation">,</span> theta<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>作图函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plot_b</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> raw_Y<span class="token punctuation">,</span> Ys<span class="token punctuation">,</span> desc<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">############</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>Ys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>X<span class="token punctuation">,</span> raw_Y<span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'red'</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'raw_data'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Ys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">'blue'</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'Regression line'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>desc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">############</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>产生结果</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">raw_train<span class="token punctuation">,</span> raw_test<span class="token punctuation">,</span> wavelengths <span class="token operator">=</span> load_data<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">## Part b.i</span>
lr_est<span class="token punctuation">,</span> theta <span class="token operator">=</span> LR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Part b.i) Theta=[%.4f, %.4f]'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>theta<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> theta<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plot_b<span class="token punctuation">(</span>wavelengths<span class="token punctuation">,</span> raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>lr_est<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Regression line'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'ps1q5b1.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>Part b.i) Theta=[2.5134, -0.0010]
</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_17_1.png?raw=true" alt="png"></p>
<p>(ii)利用a中的公式$\theta =( X^T WX )^{-1} X^TWy$计算</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">LWR_smooth</span><span class="token punctuation">(</span>spectrum<span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> tau<span class="token punctuation">)</span><span class="token punctuation">:</span>
    smooth_spectrum <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">###############</span>
    X <span class="token operator">=</span> add_intercept<span class="token punctuation">(</span>wavelengths<span class="token punctuation">)</span>
    Y <span class="token operator">=</span> spectrum<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>wavelengths<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        w <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>wavelengths <span class="token operator">-</span> wavelengths<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span> <span class="token operator">/</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>tau<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        W <span class="token operator">=</span> np<span class="token punctuation">.</span>diag<span class="token punctuation">(</span>w<span class="token punctuation">)</span>
        theta <span class="token operator">=</span> inv<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">.</span>T<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>Y<span class="token punctuation">)</span>
        yhat <span class="token operator">=</span> theta<span class="token punctuation">.</span>T<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        smooth_spectrum <span class="token operator">=</span> np<span class="token punctuation">.</span>append<span class="token punctuation">(</span>smooth_spectrum<span class="token punctuation">,</span> yhat<span class="token punctuation">)</span>
    <span class="token comment">###############</span>
    <span class="token keyword">return</span> smooth_spectrum<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>计算结果</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">## Part b.ii</span>
lwr_est_5 <span class="token operator">=</span> LWR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
plot_b<span class="token punctuation">(</span>wavelengths<span class="token punctuation">,</span> raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>lwr_est_5<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'tau = 5'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'ps1q5b2.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_21_0.png?raw=true" alt="png"></p>
<p>对不同的参数作图。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">### Part b.iii</span>
lwr_est_1 <span class="token operator">=</span> LWR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
lwr_est_10 <span class="token operator">=</span> LWR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
lwr_est_100 <span class="token operator">=</span> LWR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
lwr_est_1000 <span class="token operator">=</span> LWR_smooth<span class="token punctuation">(</span>raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
plot_b<span class="token punctuation">(</span>wavelengths<span class="token punctuation">,</span> raw_train<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span>lwr_est_1<span class="token punctuation">,</span> lwr_est_5<span class="token punctuation">,</span> lwr_est_10<span class="token punctuation">,</span> lwr_est_100<span class="token punctuation">,</span> lwr_est_1000<span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token punctuation">[</span><span class="token string">'tau = 1'</span><span class="token punctuation">,</span> <span class="token string">'tau = 5'</span><span class="token punctuation">,</span> <span class="token string">'tau = 10'</span><span class="token punctuation">,</span> <span class="token string">'tau = 100'</span><span class="token punctuation">,</span> <span class="token string">'tau = 1000'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
         <span class="token string">'ps1q5b3.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_23_0.png?raw=true" alt="png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_23_1.png?raw=true" alt="png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_23_2.png?raw=true" alt="png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_23_3.png?raw=true" alt="png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_23_4.png?raw=true" alt=""></p>
<p>(c)</p>
<p>(i)</p>
<p>第一步是利用局部加权回归来使得数据更平滑一些。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">smooth_data</span><span class="token punctuation">(</span>raw<span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> tau<span class="token punctuation">)</span><span class="token punctuation">:</span>
    smooth <span class="token operator">=</span> <span class="token boolean">None</span>
    <span class="token comment">################</span>
    smooth <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> spectrum <span class="token keyword">in</span> raw<span class="token punctuation">:</span>
        smooth<span class="token punctuation">.</span>append<span class="token punctuation">(</span>LWR_smooth<span class="token punctuation">(</span>spectrum<span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> tau<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">################</span>
    <span class="token keyword">return</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>smooth<span class="token punctuation">)</span>

smooth_train<span class="token punctuation">,</span> smooth_test <span class="token operator">=</span> <span class="token punctuation">[</span>smooth_data<span class="token punctuation">(</span>raw<span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token keyword">for</span> raw <span class="token keyword">in</span> <span class="token punctuation">[</span>raw_train<span class="token punctuation">,</span> raw_test<span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>(ii)<br>这部分比较难懂，详细解释下各个步骤，第一步将数据分为左边和右边，波长小于1200的为left，大于1300的为right，利用如下函数完成这部分工作。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">split</span><span class="token punctuation">(</span>full<span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span><span class="token punctuation">:</span>
    left<span class="token punctuation">,</span> right <span class="token operator">=</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>
    <span class="token comment">###############</span>
    indexl <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>wavelengths <span class="token operator">==</span> <span class="token number">1200</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    indexr <span class="token operator">=</span> np<span class="token punctuation">.</span>argwhere<span class="token punctuation">(</span>wavelengths <span class="token operator">==</span> <span class="token number">1300</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    left <span class="token operator">=</span> full<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span>indexl<span class="token punctuation">]</span>
    right <span class="token operator">=</span> full<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> indexr<span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token comment">###############</span>
    <span class="token keyword">return</span> left<span class="token punctuation">,</span> right<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>第二步要计算距离，定义如下函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">dist</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    dist <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment">################</span>
    dist <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">################</span>
    <span class="token keyword">return</span> dist<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#### Part c.ii</span>
left_train<span class="token punctuation">,</span> right_train <span class="token operator">=</span> split<span class="token punctuation">(</span>smooth_train<span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span>
left_test<span class="token punctuation">,</span> right_test <span class="token operator">=</span> split<span class="token punctuation">(</span>smooth_test<span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>最后一步是最复杂的，首先计算距离，这里的距离定义为</p>
<script type="math/tex; mode=display">
d(f_1, f_2) = \sum_i (f_1(λ_i) − f_2(λ_i))^2</script><p>对于此题来说，$f_1(\lambda),f_2(\lambda)$分别对应了测试数据以及训练数据，利用下式计算距离矩阵。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> <span class="token punctuation">(</span>right_train <span class="token operator">-</span> right_test<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>

<span class="token comment">#求和</span>
d1 <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>然后要找到距离最近的$k$个点，这里为$3$个点，我的思路是先对数据进行排序，然后找到前三个数据的索引</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#找到排名前3的作为neighb_k(f_right)</span>
tempd <span class="token operator">=</span> d1<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
tempd<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#找到索引</span>
index <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>接着计算$h$，为距离的最大值，根据题目中的公式对数据进行转换</p>
<pre><code>h = d1.max()
d1 = d1/h
</code></pre><p>最后一步根据kernel以及题目中的公式计算即可</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">d1 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> d1
<span class="token comment">#求lefthat</span>
a <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>left_train<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> d1<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

lefthat <span class="token operator">=</span> a<span class="token operator">/</span>b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上全部综合起来就是如下函数：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">func_reg</span><span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">,</span> right_test<span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token punctuation">,</span> n <span class="token operator">=</span> left_train<span class="token punctuation">.</span>shape
    <span class="token comment">#m=200,n=50</span>
    lefthat <span class="token operator">=</span> np<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    <span class="token comment">###########################</span>
    <span class="token comment">#right_train 200*300</span>
    <span class="token comment">#right_test  1*300</span>
    <span class="token comment">#left_train  200*50</span>
    <span class="token comment">#求题目中的d(f1,f2),先求每个点的距离,200*300矩阵</span>
    d <span class="token operator">=</span> <span class="token punctuation">(</span>right_train <span class="token operator">-</span> right_test<span class="token punctuation">)</span><span class="token operator">**</span><span class="token number">2</span>
    <span class="token comment">#按照行求和200*1</span>
    d1 <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token comment">#找到排名前3的作为neighb_k(f_right)</span>
    tempd <span class="token operator">=</span> d1<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    tempd<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#找到索引</span>
    index <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">|</span><span class="token punctuation">(</span>d1<span class="token operator">==</span>tempd<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">#h为d1中的最大值</span>
    h <span class="token operator">=</span> d1<span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    d1 <span class="token operator">=</span> d1<span class="token operator">/</span>h
    <span class="token comment">#ker (1-t)</span>
    d1 <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">-</span> d1
    <span class="token comment">#求lefthat</span>
    a <span class="token operator">=</span> <span class="token punctuation">(</span>d1<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>dot<span class="token punctuation">(</span>left_train<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    b <span class="token operator">=</span> d1<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    lefthat <span class="token operator">=</span> a<span class="token operator">/</span>b
    <span class="token comment">###########################</span>
    <span class="token keyword">return</span> lefthat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>作图函数</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#将左边右边区分开来,左边&lt;1200,右边>=1300</span>
<span class="token keyword">def</span> <span class="token function">plot_c</span><span class="token punctuation">(</span>Yhat<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> X<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">:</span>
    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">############</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">,</span>Yhat<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>X<span class="token punctuation">,</span>Y<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">#############</span>
    plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>filename<span class="token punctuation">)</span>
    <span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>产生结果</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#### Part c.ii</span>
left_train<span class="token punctuation">,</span> right_train <span class="token operator">=</span> split<span class="token punctuation">(</span>smooth_train<span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span>
left_test<span class="token punctuation">,</span> right_test <span class="token operator">=</span> split<span class="token punctuation">(</span>smooth_test<span class="token punctuation">,</span> wavelengths<span class="token punctuation">)</span>

train_errors <span class="token operator">=</span> <span class="token punctuation">[</span>dist<span class="token punctuation">(</span>left<span class="token punctuation">,</span> func_reg<span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> left<span class="token punctuation">,</span> right <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Part c.ii) Training error: %.4f'</span> <span class="token operator">%</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>train_errors<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>Part c.ii) Training error: 1.0664
</code></pre><p>(iii)</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">### Part c.iii</span>
test_errors <span class="token operator">=</span> <span class="token punctuation">[</span>dist<span class="token punctuation">(</span>left<span class="token punctuation">,</span> func_reg<span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">,</span> right<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> left<span class="token punctuation">,</span> right <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>left_test<span class="token punctuation">,</span> right_test<span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Part c.iii) Test error: %.4f'</span> <span class="token operator">%</span> np<span class="token punctuation">.</span>mean<span class="token punctuation">(</span>test_errors<span class="token punctuation">)</span><span class="token punctuation">)</span>

left_1 <span class="token operator">=</span> func_reg<span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">,</span> right_test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot_c<span class="token punctuation">(</span>left_1<span class="token punctuation">,</span> smooth_test<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token string">'ps1q5c3_1.png'</span><span class="token punctuation">)</span>
left_6 <span class="token operator">=</span> func_reg<span class="token punctuation">(</span>left_train<span class="token punctuation">,</span> right_train<span class="token punctuation">,</span> right_test<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
plot_c<span class="token punctuation">(</span>left_6<span class="token punctuation">,</span> smooth_test<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> wavelengths<span class="token punctuation">,</span> <span class="token string">'ps1q5c3_6.png'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre><code>Part c.iii) Test error: 2.7100
</code></pre><p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_37_1.png?raw=true" alt="png"></p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/CS229/blob/master/17autumn/ps1/md/output_37_3.png?raw=true" alt="png"></p>
<p>全部代码可以查看my_quasars.py这个文件。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Doraemonzzz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.doraemonzzz.com/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/">http://www.doraemonzzz.com/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.doraemonzzz.com" target="_blank">Doraemonzzz</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CS229/">CS229</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/03/01/CS229%20%E8%80%81%E7%89%88%E4%BD%9C%E4%B8%9A1/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CS229 老版作业1</div></div></a></div><div class="next-post pull-right"><a href="/2019/03/01/CS229%202017%E7%89%88%E4%BD%9C%E4%B8%9A0/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">CS229 2017版作业0</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/03/01/CS229 2017版作业0/" title="CS229 2017版作业0"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-03-01</div><div class="title">CS229 2017版作业0</div></div></a></div><div><a href="/2019/04/02/CS229 2017版作业4/" title="CS229 2017版作业4"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-04-02</div><div class="title">CS229 2017版作业4</div></div></a></div><div><a href="/2018/12/16/CS229 Lesson 10 特征选择/" title="CS229 Lesson 10 特征选择"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-16</div><div class="title">CS229 Lesson 10 特征选择</div></div></a></div><div><a href="/2018/12/12/CS229 Hoeffding不等式补充资料/" title="CS229 Hoeffding不等式补充资料"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-12</div><div class="title">CS229 Hoeffding不等式补充资料</div></div></a></div><div><a href="/2018/12/31/CS229 Lesson 12 K-means算法/" title="CS229 Lesson 12 K-means算法"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-31</div><div class="title">CS229 Lesson 12 K-means算法</div></div></a></div><div><a href="/2018/12/25/CS229 Lesson 11 贝叶斯统计正则化/" title="CS229 Lesson 11 贝叶斯统计正则化"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-12-25</div><div class="title">CS229 Lesson 11 贝叶斯统计正则化</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Livere</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNDcxOS8xMTI1Ng=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Doraemonzzz</div><div class="author-info__description">个人博客，主要记录有关机器学习，数学以及计算机科学的笔记</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">744</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">75</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">30</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Doraemonzzz"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Doraemonzzz" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/doraemon_zzz@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/291079982" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">暂无公告</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Logistic-regression"><span class="toc-number">1.</span> <span class="toc-text">1.Logistic regression</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Poisson-regression-and-the-exponential-family"><span class="toc-number">2.</span> <span class="toc-text">2.Poisson regression and the exponential family</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Gaussian-discriminant-analysis"><span class="toc-number">3.</span> <span class="toc-text">3.Gaussian discriminant analysis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Linear-invariance-of-optimization-algorithms"><span class="toc-number">4.</span> <span class="toc-text">4.Linear invariance of optimization algorithms</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Regression-for-denoising-quasar-spectra"><span class="toc-number">5.</span> <span class="toc-text">5.Regression for denoising quasar spectra</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/09/14/2022-9-14-GAMES101-Lecture-4-Transformation-Cont/" title="GAMES101 Lecture 4 Transformation Cont"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101 Lecture 4 Transformation Cont"/></a><div class="content"><a class="title" href="/2022/09/14/2022-9-14-GAMES101-Lecture-4-Transformation-Cont/" title="GAMES101 Lecture 4 Transformation Cont">GAMES101 Lecture 4 Transformation Cont</a><time datetime="2022-09-14T14:17:00.000Z" title="发表于 2022-09-14 22:17:00">2022-09-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/12/2022-9-12-GAMES101-Lecture-3-Transformation/" title="GAMES101 Lecture 3 Transformation"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101 Lecture 3 Transformation"/></a><div class="content"><a class="title" href="/2022/09/12/2022-9-12-GAMES101-Lecture-3-Transformation/" title="GAMES101 Lecture 3 Transformation">GAMES101 Lecture 3 Transformation</a><time datetime="2022-09-12T14:17:00.000Z" title="发表于 2022-09-12 22:17:00">2022-09-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/07/2022-9-7-GAMES101-Lecture-2-Review-of-Linear-Algebra/" title="GAMES101 Lecture 2 Review of Linear Algebra"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101 Lecture 2 Review of Linear Algebra"/></a><div class="content"><a class="title" href="/2022/09/07/2022-9-7-GAMES101-Lecture-2-Review-of-Linear-Algebra/" title="GAMES101 Lecture 2 Review of Linear Algebra">GAMES101 Lecture 2 Review of Linear Algebra</a><time datetime="2022-09-07T15:06:00.000Z" title="发表于 2022-09-07 23:06:00">2022-09-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/07/2022-9-7-GAMES101-Lecture-1-Overview-of-Computer-Graphics/" title="GAMES101 Lecture 1 Overview of Computer Graphics"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101 Lecture 1 Overview of Computer Graphics"/></a><div class="content"><a class="title" href="/2022/09/07/2022-9-7-GAMES101-Lecture-1-Overview-of-Computer-Graphics/" title="GAMES101 Lecture 1 Overview of Computer Graphics">GAMES101 Lecture 1 Overview of Computer Graphics</a><time datetime="2022-09-07T13:53:00.000Z" title="发表于 2022-09-07 21:53:00">2022-09-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/06/2022-9-6-GAMES101-HW2/" title="GAMES101 HW2"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="GAMES101 HW2"/></a><div class="content"><a class="title" href="/2022/09/06/2022-9-6-GAMES101-HW2/" title="GAMES101 HW2">GAMES101 HW2</a><time datetime="2022-09-06T15:45:00.000Z" title="发表于 2022-09-06 23:45:00">2022-09-06</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2022 By Doraemonzzz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.25
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'IpnmxCW9CvYWIXbol5QXsegX-MdYXbMMI',
      appKey: 'w57DVCdbxcyB1TYYagMIMJIU',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Valine' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>