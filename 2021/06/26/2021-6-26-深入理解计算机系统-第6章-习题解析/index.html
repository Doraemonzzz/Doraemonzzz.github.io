<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>深入理解计算机系统 第6章 习题解析 | Doraemonzzz</title><meta name="keywords" content="深入理解计算机系统"><meta name="author" content="Doraemonzzz"><meta name="copyright" content="Doraemonzzz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这次更新第6章习题。 参考资料：  https:&#x2F;&#x2F;dreamanddead.github.io&#x2F;CSAPP-3e-Solutions&#x2F;chapter6 https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;zh&#x2F;%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F https:&#x2F;&#x2F;unix.stackexchange.com&#x2F;questions&#x2F;167038&#x2F;i">
<meta property="og:type" content="article">
<meta property="og:title" content="深入理解计算机系统 第6章 习题解析">
<meta property="og:url" content="http://www.doraemonzzz.com/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/index.html">
<meta property="og:site_name" content="Doraemonzzz">
<meta property="og:description" content="这次更新第6章习题。 参考资料：  https:&#x2F;&#x2F;dreamanddead.github.io&#x2F;CSAPP-3e-Solutions&#x2F;chapter6 https:&#x2F;&#x2F;zh.wikipedia.org&#x2F;zh&#x2F;%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F https:&#x2F;&#x2F;unix.stackexchange.com&#x2F;questions&#x2F;167038&#x2F;i">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-06-26T08:02:00.000Z">
<meta property="article:modified_time" content="2021-08-01T04:59:57.922Z">
<meta property="article:author" content="Doraemonzzz">
<meta property="article:tag" content="深入理解计算机系统">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true"><link rel="canonical" href="http://www.doraemonzzz.com/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f00f37f957f0608abb8c571105456f0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-G-RE4B1LKRZD"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-G-RE4B1LKRZD');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"距离上次更新已经","messageNext":"天了，文章内容可能已经过时。"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '深入理解计算机系统 第6章 习题解析',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-08-01 12:59:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/bilibili.css" media="defer" onload="this.media='all'"><meta name="google-site-verification" content="c4v-NmuUZRgl3cvtg9GKswryK1YLaPztd_5M-df5VNI" /><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Doraemonzzz" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">786</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">79</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">32</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Doraemonzzz</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">深入理解计算机系统 第6章 习题解析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-26T08:02:00.000Z" title="发表于 2021-06-26 16:02:00">2021-06-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-08-01T04:59:57.922Z" title="更新于 2021-08-01 12:59:57">2021-08-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/">计算机原理</a></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">深入理解计算机系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">5.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>30分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" data-flag-title="深入理解计算机系统 第6章 习题解析"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>这次更新第6章习题。</p>
<p>参考资料：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://dreamanddead.github.io/CSAPP-3e-Solutions/chapter6">https://dreamanddead.github.io/CSAPP-3e-Solutions/chapter6</a></li>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh/%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F">https://zh.wikipedia.org/zh/%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F</a></li>
<li><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/167038/is-there-any-way-to-know-the-size-of-l1-l2-l3-cache-and-ram-in-linux">https://unix.stackexchange.com/questions/167038/is-there-any-way-to-know-the-size-of-l1-l2-l3-cache-and-ram-in-linux</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kekukele/p/3829369.html?wework_cfm_code=M8Cqb2ks4L%2BsND75%2FNCam4bak6vx5un7Fr%2BxzPv9xCxMh3ihzvKX75lVcSwK%2FeDS%2F18ogZKaBEskYzQ8zZEYnPGNXb37HFryLTWAaifxaJ0cJQUZLYjQXv8%3D">https://www.cnblogs.com/kekukele/p/3829369.html?wework_cfm_code=M8Cqb2ks4L%2BsND75%2FNCam4bak6vx5un7Fr%2BxzPv9xCxMh3ihzvKX75lVcSwK%2FeDS%2F18ogZKaBEskYzQ8zZEYnPGNXb37HFryLTWAaifxaJ0cJQUZLYjQXv8%3D</a></li>
</ul>
<span id="more"></span>
<h4 id="6-22"><a href="#6-22" class="headerlink" title="6.22"></a>6.22</h4><p>总容量$r$为</p>
<script type="math/tex; mode=display">
\begin{aligned}
r & = (2\pi xr)\times (1-x)r\\
&=2\pi r^2 x(1-x)\\
&\le 2\pi r^2 \times \frac 12 \times \frac 1 2\\
&=\frac{\pi r}{2}

\end{aligned}</script><p>当且仅当$x=\frac 1 2$时取等号。</p>
<h4 id="6-23"><a href="#6-23" class="headerlink" title="6.23"></a>6.23</h4><p>RPM含义为每分钟旋转数，更具体的见：</p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh/%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F">https://zh.wikipedia.org/zh/%E6%AF%8F%E5%88%86%E9%90%98%E8%BD%89%E9%80%9F</a></p>
<p>旋转时间（以ms为单位）：</p>
<script type="math/tex; mode=display">
\begin{aligned}
T_{\text {avg rotation}}
&=\frac 1 2\times \frac{1}{\mathrm{RPM}} \times \frac{60\ \mathrm{s}}{1\ \mathrm{min}}\times 1000\\
&=\frac 1 2\times \frac{1}{15000} \times 60 \times 1000\\
&=2

\end{aligned}</script><p>传送时间（以ms为单位）：</p>
<script type="math/tex; mode=display">
\begin{aligned}
T_{\text {avg transfer}}
&=\frac{1}{\mathrm{RPM}} \times \frac{1}{(\text { 平均扇区数 } / \text { 磁 道 })} \times \frac{60\ \mathrm{s}}{1 \mathrm{\ min}}\times 1000\\
&=\frac{1}{15000}\times \frac{1}{800}\times 60\times 1000\\
&=0.005

\end{aligned}</script><p>总访问时间为：</p>
<script type="math/tex; mode=display">
T_{\text {access }}=T_{\text {avg seck }}+T_{\text {avg rotation }}+T_{\text {avg transer }}=4 \mathrm{~ms}+2 \mathrm{~ms}+0.005 \mathrm{~ms}=6.005 \mathrm{~ms}</script><h4 id="6-24"><a href="#6-24" class="headerlink" title="6.24"></a>6.24</h4><p>应该文件的包含的扇区数量为：</p>
<script type="math/tex; mode=display">
2\times 1000 \times 1024/ 512 =  4000</script><p>旋转时间（以ms为单位）：</p>
<script type="math/tex; mode=display">
\begin{aligned}
T_{\text {max rotation}}
&=\frac{1}{\mathrm{RPM}} \times \frac{60\ \mathrm{s}}{1\ \mathrm{min}}\\
&=\frac{1}{15000} \times 60 \times 1000\\
&=4\\
T_{\text {avg rotation}}
&=\frac 1 2\times T_{\text {avg rotation}}\\
&= 2

\end{aligned}</script><h5 id="A"><a href="#A" class="headerlink" title="A"></a>A</h5><p>注意到转动一圈可以访问$1000$个扇区，所以最好情况为访问$4$圈即可，因此时间为</p>
<script type="math/tex; mode=display">
T_{\text {avg seck}}+T_{\text {avg rotation}} + 4\times T_{\text {max rotation}}
=4+ 2+ 4\times 4 = 22</script><h5 id="B"><a href="#B" class="headerlink" title="B"></a>B</h5><p>最坏情况为每次访问需要转一圈，因此时间为</p>
<script type="math/tex; mode=display">
4000\times(T_{\text {avg seck}}+T_{\text {avg rotation}})
=4000\times (4 +2) = 24000</script><h4 id="6-25"><a href="#6-25" class="headerlink" title="6.25"></a>6.25</h4><div class="table-container">
<table>
<thead>
<tr>
<th>高速缓存</th>
<th>$m$</th>
<th>$C$</th>
<th>$B$</th>
<th>$E$</th>
<th>$S$</th>
<th>$t$</th>
<th>$s$</th>
<th>$b$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.</td>
<td>32</td>
<td>1024</td>
<td>4</td>
<td>4</td>
<td>64</td>
<td>24</td>
<td>6</td>
<td>2</td>
</tr>
<tr>
<td>2.</td>
<td>32</td>
<td>1024</td>
<td>4</td>
<td>256</td>
<td>1</td>
<td>30</td>
<td>0</td>
<td>2</td>
</tr>
<tr>
<td>3.</td>
<td>32</td>
<td>1024</td>
<td>8</td>
<td>1</td>
<td>128</td>
<td>22</td>
<td>7</td>
<td>3</td>
</tr>
<tr>
<td>4.</td>
<td>32</td>
<td>1024</td>
<td>8</td>
<td>128</td>
<td>1</td>
<td>29</td>
<td>0</td>
<td>3</td>
</tr>
<tr>
<td>5.</td>
<td>32</td>
<td>1024</td>
<td>32</td>
<td>1</td>
<td>32</td>
<td>22</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<td>6.</td>
<td>32</td>
<td>1024</td>
<td>32</td>
<td>4</td>
<td>8</td>
<td>24</td>
<td>3</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-26"><a href="#6-26" class="headerlink" title="6.26"></a>6.26</h4><div class="table-container">
<table>
<thead>
<tr>
<th>高速缓存</th>
<th>$m$</th>
<th>$C$</th>
<th>$B$</th>
<th>$E$</th>
<th>$S$</th>
<th>$t$</th>
<th>$s$</th>
<th>$b$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.</td>
<td>32</td>
<td>2048</td>
<td>8</td>
<td>1</td>
<td>256</td>
<td>21</td>
<td>8</td>
<td>3</td>
</tr>
<tr>
<td>2.</td>
<td>32</td>
<td>2048</td>
<td>4</td>
<td>4</td>
<td>128</td>
<td>23</td>
<td>7</td>
<td>2</td>
</tr>
<tr>
<td>3.</td>
<td>32</td>
<td>1024</td>
<td>2</td>
<td>8</td>
<td>64</td>
<td>25</td>
<td>6</td>
<td>1</td>
</tr>
<tr>
<td>4.</td>
<td>32</td>
<td>1024</td>
<td>32</td>
<td>2</td>
<td>16</td>
<td>23</td>
<td>4</td>
<td>5</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-27"><a href="#6-27" class="headerlink" title="6.27"></a>6.27</h4><p>练习6.12的高速缓存如下：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/%E7%AC%AC6%E7%AB%A0/2021062601.jpg?raw=true" alt=""></p>
<p>后续符号的含义如下：</p>
<ul>
<li>CO: 高速缓存块偏移</li>
<li>CI: 高速缓存组索引</li>
<li>CT: 高速缓存标记</li>
</ul>
<p>对应关系：</p>
<script type="math/tex; mode=display">
\begin{array}{|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline 12 & 11 &10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\
\hline \text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CI} & \text{CI} & \text{CI} & \text{CO} & \text{CO}  \\
\hline
\end{array}</script><h5 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h5><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x45</td>
<td>0x1</td>
<td>0x0~0x3</td>
</tr>
<tr>
<td>0x38</td>
<td>0x1</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">0100,0101,001,00 ~ 0100,0101,001,11
0,1000,1010,0100 ~ 0,1000,1010,0111
0x08A4 ~ 0x08A7

0011,1000,001,00 ~ 0011,1000,001,11
0,0111,0000,0100 ~ 0,0111,0000,0111
0x0704 ~ 0x0707<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="B-1"><a href="#B-1" class="headerlink" title="B"></a>B</h5><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x91</td>
<td>0x6</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">1001,0001,110,00 ~ 1001,0001,110,11
1,0010,0011,1000 ~ 1,0010,0011,1011
0x1238 ~ 0x123E<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="6-28"><a href="#6-28" class="headerlink" title="6.28"></a>6.28</h4><p>练习6.12的高速缓存如下：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/%E7%AC%AC6%E7%AB%A0/2021062601.jpg?raw=true" alt=""></p>
<h5 id="A-2"><a href="#A-2" class="headerlink" title="A"></a>A</h5><p>无法命中组2。</p>
<h5 id="B-2"><a href="#B-2" class="headerlink" title="B"></a>B</h5><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xC7</td>
<td>0x4</td>
<td>0x0~0x3</td>
</tr>
<tr>
<td>0x05</td>
<td>0x4</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">1100,0111,100,00 ~ 1100,0111,100,11
1,1000,1111,0000 ~ 1,1000,1111,0011
0x18F0 ~ 0x18F3

0000,0101,100,00 ~ 0000,0101,100,11
0,0000,1011,0000 ~ 0,0000,1011,0011
0x00B0 ~ 0x00B3<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="C"><a href="#C" class="headerlink" title="C"></a>C</h5><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x71</td>
<td>0x5</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">0111,0001,101,00 ~ 0111,0001,101,11
0,1110,0011,0100 ~ 0,1110,0011,0111
0x0E34 ~ 0x0E37<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h5 id="D"><a href="#D" class="headerlink" title="D"></a>D</h5><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xDE</td>
<td>0x7</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">1101,1110,111,00 ~ 1101,1110,111,11
1,1011,1101,1100 ~ 1,1011,1101,1111
0x1BDC ~ 0x1BDF<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h4 id="6-29"><a href="#6-29" class="headerlink" title="6.29"></a>6.29</h4><p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/%E7%AC%AC6%E7%AB%A0/2021062602.jpg?raw=true" alt=""></p>
<h5 id="A-3"><a href="#A-3" class="headerlink" title="A"></a>A</h5><script type="math/tex; mode=display">
\begin{array}{|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline 12 & 11 &10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\
\hline \text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} & \text{CI} & \text{CI} & \text{CO} & \text{CO}  \\
\hline
\end{array}</script><p>所以CT占9位，CI占2位，CO占2位。</p>
<h5 id="B-3"><a href="#B-3" class="headerlink" title="B"></a>B</h5><div class="table-container">
<table>
<thead>
<tr>
<th>操作</th>
<th>地址</th>
<th>二进制</th>
<th>CT</th>
<th>CI</th>
<th>CO</th>
<th>命中？</th>
<th>读出的值（或者未知）</th>
</tr>
</thead>
<tbody>
<tr>
<td>读</td>
<td>0x834</td>
<td>0,1000,0011,0100</td>
<td>0b0,1000,0011=0x083</td>
<td>0b01=0x1</td>
<td>0b00=0x0</td>
<td>否</td>
<td>未知</td>
</tr>
<tr>
<td>写</td>
<td>0x836</td>
<td>0,1000,0011,0110</td>
<td>0b0,1000,0011=0x083</td>
<td>0b01=0x1</td>
<td>0b10=0x2</td>
<td>是</td>
<td>未知</td>
</tr>
<tr>
<td>读</td>
<td>0xFFD</td>
<td>0,1111,1111,1101</td>
<td>0b0,1111,1111=0x0FF</td>
<td>0b11=0x3</td>
<td>0b01=0x3</td>
<td>是</td>
<td>0xFF</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-30"><a href="#6-30" class="headerlink" title="6.30"></a>6.30</h4><p>缓存：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/%E7%AC%AC6%E7%AB%A0/2021062603.jpg?raw=true" alt=""></p>
<h5 id="A-4"><a href="#A-4" class="headerlink" title="A"></a>A</h5><script type="math/tex; mode=display">
C=B\times E \times S= 4\times 4 \times 8 = 128</script><h5 id="B-4"><a href="#B-4" class="headerlink" title="B"></a>B</h5><script type="math/tex; mode=display">
\begin{array}{|l|l|l|l|l|l|l|l|l|l|l|l|l|}
\hline 12 & 11 &10 & 9 & 8 & 7 & 6 & 5 & 4 & 3 & 2 & 1 & 0 \\
\hline \text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CT} &\text{CI} & \text{CI} & \text{CI} & \text{CO} & \text{CO}  \\
\hline
\end{array}</script><p>CT占8位，CI占3位，CO占2位。</p>
<h4 id="6-31"><a href="#6-31" class="headerlink" title="6.31"></a>6.31</h4><h5 id="A-B"><a href="#A-B" class="headerlink" title="A, B"></a>A, B</h5><pre class="line-numbers language-none"><code class="language-none">0x071A
0,0111,0001,1010
0011,1000,110,10
CT&#x3D;0x38
CI&#x3D;0x6
CO&#x3D;0x2
命中
0xEB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-32"><a href="#6-32" class="headerlink" title="6.32"></a>6.32</h4><h5 id="A-B-1"><a href="#A-B-1" class="headerlink" title="A, B"></a>A, B</h5><pre class="line-numbers language-none"><code class="language-none">0x16E8
1,0110,1110,1000
1011,0111,010,00
CT&#x3D;0xB7
CI&#x3D;0x2
CO&#x3D;0x0
未命中<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-33"><a href="#6-33" class="headerlink" title="6.33"></a>6.33</h4><div class="table-container">
<table>
<thead>
<tr>
<th>CT</th>
<th>CI</th>
<th>CO</th>
</tr>
</thead>
<tbody>
<tr>
<td>0xBC</td>
<td>0x2</td>
<td>0x0~0x3</td>
</tr>
<tr>
<td>0xB6</td>
<td>0x2</td>
<td>0x0~0x3</td>
</tr>
</tbody>
</table>
</div>
<p>二进制：</p>
<pre class="line-numbers language-none"><code class="language-none">1011,1100,010,00 ~ 1011,1100,010,11
1,0111,1000,1000 ~ 1,0111,1000,1011
0x1788 ~ 0x178B

1011,0110,010,00 ~ 1011,0110,010,11
1,0110,1100,1000 ~ 1,0110,1100,1011
0x16C8 ~ 0x16CB<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-34"><a href="#6-34" class="headerlink" title="6.34"></a>6.34</h4><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">transpose2</span><span class="token punctuation">(</span>array dst<span class="token punctuation">,</span> array src<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			dst<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>	
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>高速缓存块共有两块，正好能存储两行数据，srt和dst的相同行映射到同一缓存块，代码运行时高速缓存的状态变化如下：</p>
<p>第一轮外循环：</p>
<pre class="line-numbers language-none"><code class="language-none">初始状态
0:
1:

i &#x3D; 0, j &#x3D; 0
读取src[0][0](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1:

赋值dst[0][0](m)
0: dst[0][0], dst[0][1], dst[0][2], dst[0][3]
1:

i &#x3D; 0, j &#x3D; 1
读取src[0][1](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1:

赋值dst[1][0](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: dst[1][0], dst[1][1], dst[1][2], dst[1][3]

i &#x3D; 0, j &#x3D; 2
读取src[0][2](h)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: dst[1][0], dst[1][1], dst[1][2], dst[1][3]

赋值dst[2][0](m)
0: dst[2][0], dst[2][1], dst[2][2], dst[2][3]
1: dst[1][0], dst[1][1], dst[1][2], dst[1][3]

i &#x3D; 0, j &#x3D; 3
读取src[0][3](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: dst[2][0], dst[2][1], dst[2][2], dst[2][3]

赋值dst[3][0](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: dst[3][0], dst[3][1], dst[3][2], dst[3][3]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>第二轮外循环：</p>
<pre class="line-numbers language-none"><code class="language-none">初始状态
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: dst[3][0], dst[3][1], dst[3][2], dst[3][3]

i &#x3D; 1, j &#x3D; 0
读取src[1][0](m)
0: src[0][0], src[0][1], src[0][2], src[0][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

赋值dst[0][1](m)
0: dst[0][0], dst[0][1], dst[0][2], dst[0][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

i &#x3D; 1, j &#x3D; 1
读取src[1][1](h)
0: dst[0][0], dst[0][1], dst[0][2], dst[0][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

赋值dst[1][1](m)
0: dst[0][0], dst[0][1], dst[0][2], dst[0][3]
1: dst[1][0], dst[1][1], dst[1][2], dst[1][3]

i &#x3D; 1, j &#x3D; 2
读取src[1][2](m)
0: dst[0][0], dst[0][1], dst[0][2], dst[0][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

赋值dst[2][1](m)
0: dst[2][0], dst[2][1], dst[2][2], dst[2][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

i &#x3D; 1, j &#x3D; 3
读取src[1][3](h)
0: dst[2][0], dst[2][1], dst[2][2], dst[2][3]
1: src[1][0], src[1][1], src[1][2], src[1][3]

赋值dst[3][1](m)
0: dst[2][0], dst[2][1], dst[2][2], dst[2][3]
1: dst[3][0], dst[3][1], dst[3][2], dst[3][3]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>其余情形类似，因此缓存命中情况如下：</p>
<p>src：</p>
<pre class="line-numbers language-none"><code class="language-none">m m h m
m h m h
m m h m
m h m h<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>dst：</p>
<pre class="line-numbers language-none"><code class="language-none">m m m m
m m m m
m m m m
m m m m<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-35"><a href="#6-35" class="headerlink" title="6.35"></a>6.35</h4><p>高速缓存块共有八块，正好能存储全部数据，所以所有的不命中都是冷不命中，因此缓存命中情况如下：</p>
<p>dst：</p>
<pre class="line-numbers language-none"><code class="language-none">m h h h
m h h h
m h h h
m h h h<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>src：</p>
<pre class="line-numbers language-none"><code class="language-none">m h h h
m h h h
m h h h
m h h h<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-36"><a href="#6-36" class="headerlink" title="6.36"></a>6.36</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> x<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> i<span class="token punctuation">;</span>
<span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	sum <span class="token operator">+=</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>数组大小为$2 \times 128 \times 4 = 1024$字节。</p>
<h5 id="A-5"><a href="#A-5" class="headerlink" title="A"></a>A</h5><p>注意</p>
<script type="math/tex; mode=display">
\text{addrx[0][i]}\equiv \text{addrx[0][i]} \bmod 512</script><p>所以$\text{x[0][i], x[1][i]}$映射到同一缓存块，所以不命中率为100%。</p>
<h5 id="B-5"><a href="#B-5" class="headerlink" title="B"></a>B</h5><p>缓存可以容纳全部数组，所以不命中率为冷不命中率，注意一个缓存块存储4个元素，所以不命中率为$\frac 1 4$。</p>
<h5 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h5><p>回顾LRU定义（课本434）：</p>
<p><img src= "/img/loading.gif" data-lazy-src="D:\Github\md-photo\深入理解计算机系统\第6章\2021062604.jpg" alt=""></p>
<p>一共16组，每组2个高速缓存块，一个高速缓存块16字节，存储4个元素。</p>
<p>$\text{x[0][i], x[1][i]}$映射到同一组中不同块，一个缓存块存储4个元素，所以不命中率为$\frac 1 4$。</p>
<h5 id="D-1"><a href="#D-1" class="headerlink" title="D"></a>D</h5><p>不会，因为当前不命中率为冷不命中率。</p>
<h5 id="E"><a href="#E" class="headerlink" title="E"></a>E</h5><p>会，因为每次可以缓存更多的元素。</p>
<h4 id="6-37"><a href="#6-37" class="headerlink" title="6.37"></a>6.37</h4><p>原始代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">typedef</span> <span class="token keyword">int</span> <span class="token class-name">array_t</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">[</span>N<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">sumA</span><span class="token punctuation">(</span><span class="token class-name">array_t</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span>）
		<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
			sum <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
         
<span class="token keyword">int</span> <span class="token function">sumB</span><span class="token punctuation">(</span><span class="token class-name">array_t</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        	sum <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">sumC</span><span class="token punctuation">(</span><span class="token class-name">array_t</span> a<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
    <span class="token keyword">int</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> j <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> N<span class="token punctuation">;</span> i <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            sum <span class="token operator">+=</span> <span class="token punctuation">(</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>
             	   <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> a<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
 	<span class="token keyword">return</span> sum<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>array_t大小为为$4\times N^2$字节，具体如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>array_t字节数</th>
<th>$N=64$</th>
<th>$N=60$</th>
</tr>
</thead>
<tbody>
<tr>
<td>$4\times N^2$</td>
<td>16384</td>
<td>14400</td>
</tr>
</tbody>
</table>
</div>
<p>高速缓存一共$4\times 1024=4096$字节，共$4096/16=256$个高速缓存块，编号为$0\sim 255$，一个高速缓存块存储$4$个元素。</p>
<p>$\text{array_t[i][j]}$的相对地址$a[i][j]$（相对于$\mathrm{0x08000000}$）</p>
<script type="math/tex; mode=display">
a[i][j]= 4N i + 4j
= 4N i + 4j</script><p>$N=64$时，组索引为</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
......
15: a[0][60], a[0][61], a[0][62], a[0][63]

16: a[1][0], a[1][1], a[1][2], a[1][3]
17: a[1][4], a[1][5], a[1][6], a[1][7]
......
31: a[1][60], a[1][61], a[1][62], a[1][63]

......

240: a[15][0], a[15][1], a[15][2], a[15][3]
241: a[15][4], a[15][5], a[15][6], a[15][7]
...
255: a[15][60], a[15][61], a[15][62], a[15][63]

...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>$N=60$时，组索引为</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
......
14: a[0][56], a[0][57], a[0][58], a[0][59]

15: a[1][0], a[1][1], a[1][2], a[1][3]
16: a[1][4], a[1][5], a[1][6], a[1][7]
......
29: a[1][56], a[1][57], a[1][58], a[1][59]

......

235: a[15][0], a[15][1], a[15][2], a[15][3]
236: a[15][4], a[15][5], a[15][6], a[15][7]
......
239: a[15][56], a[15][57], a[15][58], a[15][59]

......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>sumA：</p>
<p>当$N=64,60$时，缓存如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0:a[0][0], a[0][1], a[0][2], a[0][3]
1:a[0][4], a[0][5], a[0][6], a[0][7]
......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>所以不命中率为$\frac 1 4$。</p>
<p>sumB:</p>
<p>当$N=64$时，缓存的过程如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
16: a[1][0], a[1][1], a[1][2], a[1][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
17: a[1][4], a[1][5], a[1][6], a[1][7]
......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>所以不命中率为$\frac 1 4$。</p>
<p>当$N=60$时，缓存的过程如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
15: a[1][0], a[1][1], a[1][2], a[1][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
16: a[1][4], a[1][5], a[1][6], a[1][7]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>所以不命中率为$\frac 1 4$。</p>
<p>sumC:</p>
<p>当$N=64$时，缓存的过程如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
16: a[1][0], a[1][1], a[1][2], a[1][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
17: a[1][4], a[1][5], a[1][6], a[1][7]
......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>所以不命中率为$\frac 1 4$。</p>
<p>当$N=60$时，缓存的过程如下：</p>
<pre class="line-numbers language-none"><code class="language-none">0: a[0][0], a[0][1], a[0][2], a[0][3]
15: a[1][0], a[1][1], a[1][2], a[1][3]
1: a[0][4], a[0][5], a[0][6], a[0][7]
16: a[1][4], a[1][5], a[1][6], a[1][7]
......<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>所以不命中率为$\frac 1 4$。</p>
<p>完整的结果如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>函数</th>
<th>$N=64$</th>
<th>$N=60$</th>
</tr>
</thead>
<tbody>
<tr>
<td>sumA</td>
<td>$\frac 1 4$</td>
<td>$\frac 1 4$</td>
</tr>
<tr>
<td>sumB</td>
<td>$\frac 1 4$</td>
<td>$\frac 1 4$</td>
</tr>
<tr>
<td>sumC</td>
<td>$\frac 1 4$</td>
<td>$\frac 1 4$</td>
</tr>
</tbody>
</table>
</div>
<h4 id="6-38"><a href="#6-38" class="headerlink" title="6.38"></a>6.38</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">point_color</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> c<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m<span class="token punctuation">;</span>
    <span class="token keyword">int</span> y<span class="token punctuation">;</span>
    <span class="token keyword">int</span> k<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">point_color</span> square<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>数组元素大小为$16\times 16\times 4 \times 4= 4096$字节，高速缓存块一共有$2048$字节，只能保存数组的$\frac 1 2$。</p>
<p>缓存一共有$2048/32=64$块，每块可以容纳$2$个元素。</p>
<h5 id="A-6"><a href="#A-6" class="headerlink" title="A"></a>A</h5><p>写总数为$16\times 16\times 4 = 1024$。</p>
<h5 id="B-6"><a href="#B-6" class="headerlink" title="B"></a>B</h5><p>缓存一共有$2048/32=64$块，每块可以容纳$2$个元素，所以每次读取$\text{square[i][0]}$会同时缓存$\text{square[i][1]}$，因此不命中的写总数为$16\times 8 =128$。</p>
<h5 id="C-2"><a href="#C-2" class="headerlink" title="C"></a>C</h5><p>不命中率为</p>
<script type="math/tex; mode=display">
\frac{128}{1024} =\frac 1 8</script><h4 id="6-39"><a href="#6-39" class="headerlink" title="6.39"></a>6.39</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        square<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="A-7"><a href="#A-7" class="headerlink" title="A"></a>A</h5><p>写总数为$16\times 16\times 4 = 1024$。</p>
<h5 id="B-7"><a href="#B-7" class="headerlink" title="B"></a>B</h5><p>注意缓存只能保存一半元素，所以读$\text{square[j+8][i]}$的第一个元素会覆盖$\text{square[j][i]}$的缓存，所以不命中数为$16\times 16$。</p>
<h5 id="C-3"><a href="#C-3" class="headerlink" title="C"></a>C</h5><p>不命中率为</p>
<script type="math/tex; mode=display">
\frac{256}{1024} =\frac 1 4</script><h4 id="6-40"><a href="#6-40" class="headerlink" title="6.40"></a>6.40</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    	square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span>·y <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        square<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>k <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="A-8"><a href="#A-8" class="headerlink" title="A"></a>A</h5><p>写总数为$16\times 16\times 4 = 1024$。</p>
<h5 id="B-8"><a href="#B-8" class="headerlink" title="B"></a>B</h5><p>缓存一共有$2048/32=64$块，每块可以容纳$2$个元素，所以第一部分的不命中数为</p>
<script type="math/tex; mode=display">
16\times 16 /2 = 128</script><p>第二部分的不命中数为</p>
<script type="math/tex; mode=display">
16\times 8=128</script><p>总不命中数为</p>
<script type="math/tex; mode=display">
128+128=256</script><h5 id="C-4"><a href="#C-4" class="headerlink" title="C"></a>C</h5><p>不命中率为</p>
<script type="math/tex; mode=display">
\frac{256}{1024} =\frac 1 4</script><h4 id="6-41"><a href="#6-41" class="headerlink" title="6.41"></a>6.41</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token class-name">pixel</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">char</span> r<span class="token punctuation">;</span>
    <span class="token keyword">char</span> g<span class="token punctuation">;</span>
    <span class="token keyword">char</span> b<span class="token punctuation">;</span>
    <span class="token keyword">char</span> a<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">struct</span> <span class="token class-name">pixel</span> buffer<span class="token punctuation">[</span><span class="token number">480</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">640</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> i<span class="token punctuation">,</span> j<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>cptr<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>iptr<span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span>j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> <span class="token number">640</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">480</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>g <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        buffer<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>数组大小为$480\times 640 \times 4=1228800$字节；高速缓存大小为$64\times 1024=65536$字节，能容纳数组的比例为$\frac{4}{15\times 5}=\frac{4}{75}$；一共有$65536/4=16384$个高速缓存块，每块容纳一个像素。</p>
<p>该代码是按列读取，每读取$\text{buffer[i][j].r}$，会缓存相应的$\text{buffer[i][j].g,buffer[i][j].b,buffer[i][j].a}$，所以不命中率为</p>
<script type="math/tex; mode=display">
\frac{480\times 640 }{480\times 640 \times 4} =\frac 1 4</script><h4 id="6-42"><a href="#6-42" class="headerlink" title="6.42"></a>6.42</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>cptr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> buffer<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> cptr <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span><span class="token punctuation">)</span> buffer<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">640</span> <span class="token operator">*</span> <span class="token number">480</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> cptr<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token operator">*</span>cptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>该代码等价于按行读取，每读取$\text{buffer[i][j].r}$，会缓存相应的$\text{buffer[i][j].g,buffer[i][j].b,buffer[i][j].a}$，所以不命中率为</p>
<script type="math/tex; mode=display">
\frac{480\times 640 }{480\times 640 \times 4} =\frac 1 4</script><h4 id="6-43"><a href="#6-43" class="headerlink" title="6.43"></a>6.43</h4><p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">char</span> <span class="token operator">*</span>iptr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> buffer<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span> iptr <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span> buffer<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">640</span> <span class="token operator">*</span> <span class="token number">480</span><span class="token punctuation">)</span><span class="token punctuation">;</span> iptr<span class="token operator">++</span><span class="token punctuation">)</span>
	<span class="token operator">*</span>iptr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>注意int的大小为4字节，所以每次赋值</p>
<pre class="line-numbers language-none"><code class="language-none">*iptr &#x3D; 0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>均不会缓存任何内容，因此不命中率为$1$</p>
<h4 id="6-44"><a href="#6-44" class="headerlink" title="6.44"></a>6.44</h4><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://unix.stackexchange.com/questions/167038/is-there-any-way-to-know-the-size-of-l1-l2-l3-cache-and-ram-in-linux">https://unix.stackexchange.com/questions/167038/is-there-any-way-to-know-the-size-of-l1-l2-l3-cache-and-ram-in-linux</a></p>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">Clock frequency is approx. 2208.0 MHz
Memory mountain (MB&#x2F;sec)
        s1      s2      s3      s4      s5      s6      s7      s8      s9      s10     s11     s12     s13     s14     s15
128m    16567   9942    6557    5049    3568    2790    2386    2168    1965    1773    1602    1637    1637    1539    1505
64m     16688   10098   6832    5186    4061    3098    2719    2316    2052    2090    1864    1623    1687    1653    1601
32m     17677   10551   7453    5327    4236    3629    2976    2642    2457    2336    2169    2010    1835    1806    1663
16m     17562   10899   8431    6670    5333    2775    3029    2744    3140    3039    2835    2816    2699    2700    2667
8m      20028   13649   11431   9330    6711    5677    4985    4170    4209    4214    4107    4085    4084    4051    4062
4m      29176   20474   17000   14585   12084   10661   9446    8403    8147    7897    7547    7243    7058    6865    6773
2m      30147   23466   19179   15521   13090   11291   9932    8824    8417    7965    7686    7315    7054    6888    6767
1024k   29927   23267   19122   15650   13127   11321   9913    8785    8338    7968    7643    7301    7068    6631    6636
512k    30039   23633   19387   16018   13389   11605   10186   9020    8673    8402    8069    7835    7802    7715    7705
256k    32167   27323   24704   21675   18841   16621   14630   13069   12837   13191   13321   15283   14981   15426   16025
128k    33535   30400   30015   28174   24884   22025   19247   16748   16747   16186   16101   16013   15946   16432   16078
64k     33388   30222   29447   26718   22296   18841   16099   13766   13764   13780   14083   13956   13410   15473   24117
32k     34852   34388   33588   33250   31730   31899   31511   28803   28300   30650   31016   33120   26246   29694   29050
16k     34585   34258   32945   30147   31450   31071   30393   30973   29548   32292   31613   28980   30912   30754   30912<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>根据课本介绍，只要看哪一行的数值变动不大即可，注意32k对应的行数值变动较小，64k对应的行数值变动较大，所以推测缓存大小为32k，使用命令验证：</p>
<pre class="line-numbers language-none"><code class="language-none">lscpu
 
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              12
On-line CPU(s) list: 0-11
Thread(s) per core:  2
Core(s) per socket:  6
Socket(s):           1
Vendor ID:           GenuineIntel
CPU family:          6
Model:               158
Model name:          Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz
Stepping:            10
CPU MHz:             2208.006
BogoMIPS:            4416.01
Hypervisor vendor:   Microsoft
Virtualization type: full
L1d cache:           32K
L1i cache:           32K
L2 cache:            256K
L3 cache:            9216K<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-45"><a href="#6-45" class="headerlink" title="6.45"></a>6.45</h4><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/kekukele/p/3829369.html?wework_cfm_code=M8Cqb2ks4L%2BsND75%2FNCam4bak6vx5un7Fr%2BxzPv9xCxMh3ihzvKX75lVcSwK%2FeDS%2F18ogZKaBEskYzQ8zZEYnPGNXb37HFryLTWAaifxaJ0cJQUZLYjQXv8%3D">https://www.cnblogs.com/kekukele/p/3829369.html?wework_cfm_code=M8Cqb2ks4L%2BsND75%2FNCam4bak6vx5un7Fr%2BxzPv9xCxMh3ihzvKX75lVcSwK%2FeDS%2F18ogZKaBEskYzQ8zZEYnPGNXb37HFryLTWAaifxaJ0cJQUZLYjQXv8%3D</a></p>
<p>首先查看缓存块的基本信息：</p>
<p>$S$：</p>
<pre class="line-numbers language-none"><code class="language-none">cat &#x2F;sys&#x2F;devices&#x2F;system&#x2F;cpu&#x2F;cpu0&#x2F;cache&#x2F;index0&#x2F;number_of_sets
64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>$E$：</p>
<pre class="line-numbers language-none"><code class="language-none">cat &#x2F;sys&#x2F;devices&#x2F;system&#x2F;cpu&#x2F;cpu0&#x2F;cache&#x2F;index0&#x2F;ways_of_associativity
8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>$B$</p>
<pre class="line-numbers language-none"><code class="language-none">cat &#x2F;sys&#x2F;devices&#x2F;system&#x2F;cpu&#x2F;cpu0&#x2F;cache&#x2F;index0&#x2F;coherency_line_size
64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>实验思路：</p>
<p>对矩阵分块进行操作，分块大小为缓存块可以容纳的矩阵行数，一共测试了如下三个版本：</p>
<ul>
<li>v1: 普通转置。</li>
<li>v2: 分块。</li>
<li>v3: 分块 + 局部变量缓存。</li>
</ul>
<p>实验代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span>

<span class="token keyword">const</span> <span class="token keyword">int</span> S <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> E <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> B <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token comment">// 矩阵维度</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> D <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
<span class="token comment">// 循环次数</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">// int大小</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 分块大小</span>
<span class="token keyword">int</span> d1<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">></span> b<span class="token punctuation">)</span> <span class="token operator">?</span> b <span class="token operator">:</span> a<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">transposeV1</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			dst<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">transposeV2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
					dst<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">transposeV3</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>dst<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token comment">// 本地变量</span>
				<span class="token keyword">int</span> a<span class="token punctuation">[</span>d1<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
					a<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token operator">=</span> src<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
					dst<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span><span class="token operator">*</span> <span class="token function">init_matrix</span><span class="token punctuation">(</span><span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>matrix <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>dim <span class="token operator">*</span> dim <span class="token operator">*</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			matrix<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> matrix<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">double</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>transpose<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>dst <span class="token operator">=</span> <span class="token function">init_matrix</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>src <span class="token operator">=</span> <span class="token function">init_matrix</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">clock_t</span> start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">transpose</span><span class="token punctuation">(</span>dst<span class="token punctuation">,</span> src<span class="token punctuation">,</span> dim<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token class-name">clock_t</span> end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> CLOCKS_PER_SEC <span class="token operator">/</span> n<span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> t<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	d1 <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>D <span class="token operator">/</span> <span class="token punctuation">(</span>B <span class="token operator">/</span> d<span class="token punctuation">)</span><span class="token punctuation">,</span> S <span class="token operator">*</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Block size is %d.\n"</span><span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"transposeV1 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>transposeV1<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"transposeV2 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>transposeV2<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"transposeV3 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>transposeV3<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">Block size is 16.
transposeV1 time: 0.000453s
transposeV2 time: 0.000199s
transposeV3 time: 0.000332s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="6-46"><a href="#6-46" class="headerlink" title="6.46"></a>6.46</h4><p>实验思路：</p>
<p>利用对称性减少运算量，对矩阵分块进行操作，分块大小为缓存块可以容纳的矩阵行数，一共测试了如下几个版本：</p>
<ul>
<li>v1: 普通。</li>
<li>v2: 局部变量缓存。</li>
<li>v3: 利用对称性减少运算量 + 局部变量缓存。</li>
<li>v4: 分块。</li>
<li>v5: 分块 + 局部变量缓存。</li>
<li>v6: 分块 + 利用对称性减少运算量 + 局部变量缓存。</li>
</ul>
<p>代码：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;math.h></span></span>

<span class="token keyword">const</span> <span class="token keyword">int</span> S <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> E <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> B <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>
<span class="token comment">// 矩阵维度</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> D <span class="token operator">=</span> <span class="token number">256</span><span class="token punctuation">;</span>
<span class="token comment">// 循环次数</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> N <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>
<span class="token comment">// int大小</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> d <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 分块大小</span>
<span class="token keyword">int</span> d1<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">min</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> <span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>a <span class="token operator">></span> b<span class="token punctuation">)</span> <span class="token operator">?</span> b <span class="token operator">:</span> a<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v1</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v2</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> tmp <span class="token operator">=</span> G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v3</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">int</span> tmp <span class="token operator">=</span> G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span><span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>j <span class="token operator">*</span> dim <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            G<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v4</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
					G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v5</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token keyword">int</span> tmp <span class="token operator">=</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
					G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
                    G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">void</span> <span class="token function">col_convert_v6</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>G<span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">// 非分块对角元素</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> i<span class="token punctuation">;</span> j <span class="token operator">+=</span> d1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
				<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                    <span class="token keyword">int</span> tmp <span class="token operator">=</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
					G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
                    G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
				<span class="token punctuation">&#125;</span>
			<span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token comment">// 分块对角元素</span>
        <span class="token keyword">int</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> s <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> s <span class="token operator">&lt;</span> d1<span class="token punctuation">;</span> s<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> t <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> t <span class="token operator">&lt;</span> s<span class="token punctuation">;</span> t<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">int</span> tmp <span class="token operator">=</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">||</span> G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span><span class="token punctuation">;</span>
                G<span class="token punctuation">[</span><span class="token punctuation">(</span>j <span class="token operator">+</span> t<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> i <span class="token operator">+</span> s<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
                G<span class="token punctuation">[</span><span class="token punctuation">(</span>i <span class="token operator">+</span> s<span class="token punctuation">)</span> <span class="token operator">*</span> dim <span class="token operator">+</span> j <span class="token operator">+</span> t<span class="token punctuation">]</span> <span class="token operator">=</span> tmp<span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span><span class="token operator">*</span> <span class="token function">init_matrix</span><span class="token punctuation">(</span><span class="token keyword">int</span> dim<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>matrix <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>dim <span class="token operator">*</span> dim <span class="token operator">*</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> dim<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			matrix<span class="token punctuation">[</span>i <span class="token operator">*</span> dim <span class="token operator">+</span> j<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">return</span> matrix<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">double</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token punctuation">(</span><span class="token operator">*</span>col_convert<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">int</span> dim<span class="token punctuation">,</span> <span class="token keyword">int</span> n<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">int</span> <span class="token operator">*</span>G <span class="token operator">=</span> <span class="token function">init_matrix</span><span class="token punctuation">(</span>dim<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token class-name">clock_t</span> start <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> n<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token function">col_convert</span><span class="token punctuation">(</span>G<span class="token punctuation">,</span> dim<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token class-name">clock_t</span> end <span class="token operator">=</span> <span class="token function">clock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">double</span> t <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">double</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span> <span class="token operator">/</span> CLOCKS_PER_SEC <span class="token operator">/</span> n<span class="token punctuation">;</span>
	
	<span class="token keyword">return</span> t<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	d1 <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>D <span class="token operator">/</span> <span class="token punctuation">(</span>B <span class="token operator">/</span> d<span class="token punctuation">)</span><span class="token punctuation">,</span> S <span class="token operator">*</span> E<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Block size is %d.\n"</span><span class="token punctuation">,</span> d1<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v1 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v1<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v2 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v2<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v3 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v3<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v4 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v4<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v5 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v5<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"col_convert_v6 time: %fs\n"</span><span class="token punctuation">,</span> <span class="token function">test</span><span class="token punctuation">(</span>col_convert_v6<span class="token punctuation">,</span> D<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">Block size is 16.
col_convert_v1 time: 0.000263s
col_convert_v2 time: 0.000311s
col_convert_v3 time: 0.000135s
col_convert_v4 time: 0.000207s
col_convert_v5 time: 0.000273s
col_convert_v6 time: 0.000145s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Doraemonzzz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.doraemonzzz.com/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/">http://www.doraemonzzz.com/2021/06/26/2021-6-26-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC6%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.doraemonzzz.com" target="_blank">Doraemonzzz</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F/">深入理解计算机系统</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/07/04/2021-7-4-Flarum-docker%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Flarum docker安装教程</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/24/2021-6-24-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E2%80%94%E2%80%94%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95%EF%BC%88%E7%AC%AC%E4%B8%83%E7%89%88%EF%BC%89Socket-Programming-Assignment-4ProxyServer/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">计算机网络——自顶向下方法（第七版）Socket Programming Assignment 4:ProxyServer</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/10/25/2021-10-25-深入理解计算机系统-第12章-习题解析/" title="深入理解计算机系统 第12章 习题解析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-10-25</div><div class="title">深入理解计算机系统 第12章 习题解析</div></div></a></div><div><a href="/2021/06/06/2021-6-6-深入理解计算机系统-第5章-习题解析/" title="深入理解计算机系统 第5章 习题解析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-06</div><div class="title">深入理解计算机系统 第5章 习题解析</div></div></a></div><div><a href="/2021/08/01/2021-8-01-深入理解计算机系统-第7章-习题解析/" title="深入理解计算机系统 第7章 习题解析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-01</div><div class="title">深入理解计算机系统 第7章 习题解析</div></div></a></div><div><a href="/2021/08/01/2021-8-1-深入理解计算机系统-第6章-笔记整理/" title="深入理解计算机系统 第6章 笔记整理"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-01</div><div class="title">深入理解计算机系统 第6章 笔记整理</div></div></a></div><div><a href="/2021/08/15/2021-8-15-深入理解计算机系统-第8章-习题解析/" title="深入理解计算机系统 第8章 习题解析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-08-15</div><div class="title">深入理解计算机系统 第8章 习题解析</div></div></a></div><div><a href="/2021/09/14/2021-9-14-深入理解计算机系统-第9章-习题解析/" title="深入理解计算机系统 第9章 习题解析"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-09-14</div><div class="title">深入理解计算机系统 第9章 习题解析</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Livere</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNDcxOS8xMTI1Ng=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Doraemonzzz</div><div class="author-info__description">个人博客，主要记录有关机器学习，数学以及计算机科学的笔记</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">786</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">79</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">32</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Doraemonzzz"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Doraemonzzz" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/doraemon_zzz@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/291079982" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">暂无公告</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-22"><span class="toc-number">1.</span> <span class="toc-text">6.22</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-23"><span class="toc-number">2.</span> <span class="toc-text">6.23</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-24"><span class="toc-number">3.</span> <span class="toc-text">6.24</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A"><span class="toc-number">3.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B"><span class="toc-number">3.2.</span> <span class="toc-text">B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-25"><span class="toc-number">4.</span> <span class="toc-text">6.25</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-26"><span class="toc-number">5.</span> <span class="toc-text">6.26</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-27"><span class="toc-number">6.</span> <span class="toc-text">6.27</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-1"><span class="toc-number">6.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-1"><span class="toc-number">6.2.</span> <span class="toc-text">B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-28"><span class="toc-number">7.</span> <span class="toc-text">6.28</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-2"><span class="toc-number">7.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-2"><span class="toc-number">7.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C"><span class="toc-number">7.3.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D"><span class="toc-number">7.4.</span> <span class="toc-text">D</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-29"><span class="toc-number">8.</span> <span class="toc-text">6.29</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-3"><span class="toc-number">8.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-3"><span class="toc-number">8.2.</span> <span class="toc-text">B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-30"><span class="toc-number">9.</span> <span class="toc-text">6.30</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-4"><span class="toc-number">9.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-4"><span class="toc-number">9.2.</span> <span class="toc-text">B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-31"><span class="toc-number">10.</span> <span class="toc-text">6.31</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-B"><span class="toc-number">10.1.</span> <span class="toc-text">A, B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-32"><span class="toc-number">11.</span> <span class="toc-text">6.32</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-B-1"><span class="toc-number">11.1.</span> <span class="toc-text">A, B</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-33"><span class="toc-number">12.</span> <span class="toc-text">6.33</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-34"><span class="toc-number">13.</span> <span class="toc-text">6.34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-35"><span class="toc-number">14.</span> <span class="toc-text">6.35</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-36"><span class="toc-number">15.</span> <span class="toc-text">6.36</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-5"><span class="toc-number">15.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-5"><span class="toc-number">15.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-1"><span class="toc-number">15.3.</span> <span class="toc-text">C</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#D-1"><span class="toc-number">15.4.</span> <span class="toc-text">D</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#E"><span class="toc-number">15.5.</span> <span class="toc-text">E</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-37"><span class="toc-number">16.</span> <span class="toc-text">6.37</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-38"><span class="toc-number">17.</span> <span class="toc-text">6.38</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-6"><span class="toc-number">17.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-6"><span class="toc-number">17.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-2"><span class="toc-number">17.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-39"><span class="toc-number">18.</span> <span class="toc-text">6.39</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-7"><span class="toc-number">18.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-7"><span class="toc-number">18.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-3"><span class="toc-number">18.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-40"><span class="toc-number">19.</span> <span class="toc-text">6.40</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#A-8"><span class="toc-number">19.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#B-8"><span class="toc-number">19.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#C-4"><span class="toc-number">19.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-41"><span class="toc-number">20.</span> <span class="toc-text">6.41</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-42"><span class="toc-number">21.</span> <span class="toc-text">6.42</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-43"><span class="toc-number">22.</span> <span class="toc-text">6.43</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-44"><span class="toc-number">23.</span> <span class="toc-text">6.44</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-45"><span class="toc-number">24.</span> <span class="toc-text">6.45</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-46"><span class="toc-number">25.</span> <span class="toc-text">6.46</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2023/01/06/2023-1-6-ECE408-Lecture-6-Generalized-Tiling-and-DRAM-Bandwidth/" title="ECE408 Lecture 6 Generalized Tiling and DRAM Bandwidth"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ECE408 Lecture 6 Generalized Tiling and DRAM Bandwidth"/></a><div class="content"><a class="title" href="/2023/01/06/2023-1-6-ECE408-Lecture-6-Generalized-Tiling-and-DRAM-Bandwidth/" title="ECE408 Lecture 6 Generalized Tiling and DRAM Bandwidth">ECE408 Lecture 6 Generalized Tiling and DRAM Bandwidth</a><time datetime="2023-01-06T06:30:00.000Z" title="发表于 2023-01-06 14:30:00">2023-01-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/06/2023-1-6-ECE408-Lecture-4-CUDA-Memory-Model/" title="ECE408 Lecture 4 CUDA Memory Model"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ECE408 Lecture 4 CUDA Memory Model"/></a><div class="content"><a class="title" href="/2023/01/06/2023-1-6-ECE408-Lecture-4-CUDA-Memory-Model/" title="ECE408 Lecture 4 CUDA Memory Model">ECE408 Lecture 4 CUDA Memory Model</a><time datetime="2023-01-06T03:07:00.000Z" title="发表于 2023-01-06 11:07:00">2023-01-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/06/2023-1-6-ECE408-Lecture-5-Locality-and-Tiled-Matrix-Multiply/" title="ECE408 Lecture 5 Locality and Tiled Matrix Multiply"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ECE408 Lecture 5 Locality and Tiled Matrix Multiply"/></a><div class="content"><a class="title" href="/2023/01/06/2023-1-6-ECE408-Lecture-5-Locality-and-Tiled-Matrix-Multiply/" title="ECE408 Lecture 5 Locality and Tiled Matrix Multiply">ECE408 Lecture 5 Locality and Tiled Matrix Multiply</a><time datetime="2023-01-06T03:07:00.000Z" title="发表于 2023-01-06 11:07:00">2023-01-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/05/2023-1-5-ECE408-Lecture-3-CUDA-Parallel-Execution-Model/" title="ECE408 Lecture 3 CUDA Parallel Execution Model"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ECE408 Lecture 3 CUDA Parallel Execution Model"/></a><div class="content"><a class="title" href="/2023/01/05/2023-1-5-ECE408-Lecture-3-CUDA-Parallel-Execution-Model/" title="ECE408 Lecture 3 CUDA Parallel Execution Model">ECE408 Lecture 3 CUDA Parallel Execution Model</a><time datetime="2023-01-05T09:03:00.000Z" title="发表于 2023-01-05 17:03:00">2023-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/01/05/2023-1-5-ECE408-Lecture-2-Introduction-to-Parallel-Computing-and-CUDA/" title="ECE408 Lecture 2 Introduction to Parallel Computing and CUDA"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ECE408 Lecture 2 Introduction to Parallel Computing and CUDA"/></a><div class="content"><a class="title" href="/2023/01/05/2023-1-5-ECE408-Lecture-2-Introduction-to-Parallel-Computing-and-CUDA/" title="ECE408 Lecture 2 Introduction to Parallel Computing and CUDA">ECE408 Lecture 2 Introduction to Parallel Computing and CUDA</a><time datetime="2023-01-05T03:53:00.000Z" title="发表于 2023-01-05 11:53:00">2023-01-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2023 By Doraemonzzz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.25
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'IpnmxCW9CvYWIXbol5QXsegX-MdYXbMMI',
      appKey: 'w57DVCdbxcyB1TYYagMIMJIU',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Valine' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>