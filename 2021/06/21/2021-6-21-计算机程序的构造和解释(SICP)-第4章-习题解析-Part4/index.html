<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>计算机程序的构造和解释(SICP) 第4章 习题解析 Part4 | Doraemonzzz</title><meta name="keywords" content="计算机程序的构造和解释"><meta name="author" content="Doraemonzzz"><meta name="copyright" content="Doraemonzzz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="这次回顾第四章第四部分习题。 学习资料： https:&#x2F;&#x2F;ocw.mit.edu&#x2F;courses&#x2F;electrical-engineering-and-computer-science&#x2F;6-001-structure-and-interpretation-of-computer-programs-spring-2005&#x2F;index.htm https:&#x2F;&#x2F;github.com&#x2F;DeathKing&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机程序的构造和解释(SICP) 第4章 习题解析 Part4">
<meta property="og:url" content="http://www.doraemonzzz.com/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/index.html">
<meta property="og:site_name" content="Doraemonzzz">
<meta property="og:description" content="这次回顾第四章第四部分习题。 学习资料： https:&#x2F;&#x2F;ocw.mit.edu&#x2F;courses&#x2F;electrical-engineering-and-computer-science&#x2F;6-001-structure-and-interpretation-of-computer-programs-spring-2005&#x2F;index.htm https:&#x2F;&#x2F;github.com&#x2F;DeathKing&#x2F;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2021-06-21T01:54:00.000Z">
<meta property="article:modified_time" content="2021-06-21T01:54:17.339Z">
<meta property="article:author" content="Doraemonzzz">
<meta property="article:tag" content="计算机程序的构造和解释">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true"><link rel="canonical" href="http://www.doraemonzzz.com/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?6f00f37f957f0608abb8c571105456f0";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-G-RE4B1LKRZD"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-G-RE4B1LKRZD');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"距离上次更新已经","messageNext":"天了，文章内容可能已经过时。"},
  highlight: {"plugin":"prismjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机程序的构造和解释(SICP) 第4章 习题解析 Part4',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-06-21 09:54:17'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><link rel="stylesheet" href="/css/bilibili.css" media="defer" onload="this.media='all'"><meta name="google-site-verification" content="c4v-NmuUZRgl3cvtg9GKswryK1YLaPztd_5M-df5VNI" /><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Doraemonzzz" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">665</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Doraemonzzz</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-chart-pie"></i><span> 博客统计</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/charts/"><i class="fa-fw far fa-chart-bar"></i><span> 文章统计</span></a></li><li><a class="site-page child" href="/census/"><i class="fa-fw fas fa-chart-area"></i><span> 访问统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/top/"><i class="fa-fw fab fa-hotjar"></i><span> 阅读排行榜</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机程序的构造和解释(SICP) 第4章 习题解析 Part4</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-06-21T01:54:00.000Z" title="发表于 2021-06-21 09:54:00">2021-06-21</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-06-21T01:54:17.339Z" title="更新于 2021-06-21 09:54:17">2021-06-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8E%9F%E7%90%86/">计算机原理</a></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A/">计算机程序的构造和解释</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>20分钟</span></span><span class="post-meta-separator">|</span><span class="leancloud_visitors" id="/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/" data-flag-title="计算机程序的构造和解释(SICP) 第4章 习题解析 Part4"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span class="leancloud-visitors-count"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>这次回顾第四章第四部分习题。</p>
<p>学习资料：</p>
<p><a target="_blank" rel="noopener" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/index.htm">https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/index.htm</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/DeathKing/Learning-SICP">https://github.com/DeathKing/Learning-SICP</a></p>
<p><a target="_blank" rel="noopener" href="https://mitpress.mit.edu/sites/default/files/sicp/index.html">https://mitpress.mit.edu/sites/default/files/sicp/index.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Xx41117tr?from=search&amp;seid=14983483066585274454">https://www.bilibili.com/video/BV1Xx41117tr?from=search&amp;seid=14983483066585274454</a></p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://sicp.readthedocs.io/en/latest">https://sicp.readthedocs.io/en/latest</a></p>
<p><a target="_blank" rel="noopener" href="http://community.schemewiki.org/?SICP-Solutions">http://community.schemewiki.org/?SICP-Solutions</a></p>
<p><a target="_blank" rel="noopener" href="http://community.schemewiki.org/?sicp">http://community.schemewiki.org/?sicp</a></p>
<p><a target="_blank" rel="noopener" href="https://liujiacai.net/blog/2016/02/22/recursion-without-name/">https://liujiacai.net/blog/2016/02/22/recursion-without-name/</a></p>
<p><a target="_blank" rel="noopener" href="https://mvanier.livejournal.com/2897.html">https://mvanier.livejournal.com/2897.html</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/jiacai2050/sicp">https://github.com/jiacai2050/sicp</a></p>
<p><a target="_blank" rel="noopener" href="https://liujiacai.net/">https://liujiacai.net/</a></p>
<span id="more"></span>
<h4 id="4-32-p286"><a href="#4-32-p286" class="headerlink" title="4.32(p286)"></a>4.32(p286)</h4><p>可以利用多出来的惰性构造一种数据结构，该数据结构只有在使用时才会被求值，例子如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token comment">; 流, 下式会直接报错</span>
<span class="token punctuation">(</span><span class="token function">cons-stream</span> <span class="token punctuation">(</span><span class="token operator">/</span> <span class="token number">2</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token punctuation">)</span>

<span class="token comment">; 此处的cons不会报错</span>
<span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token punctuation">(</span><span class="token operator">/</span> <span class="token number">2</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-33-p286"><a href="#4-33-p286" class="headerlink" title="4.33(p286)"></a>4.33(p286)</h4><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="http://community.schemewiki.org/?sicp-ex-4.33">http://community.schemewiki.org/?sicp-ex-4.33</a></p>
<p>原因是读入引号表达式得到的表为list，所以要将其转换为cons构成的表，这部分需要增加如下函数：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token comment">; change</span>
<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">text-of-quotation</span> exp env<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">arr</span> <span class="token punctuation">(</span><span class="token builtin">cadr</span> exp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">pair?</span> arr<span class="token punctuation">)</span>
             <span class="token punctuation">(</span><span class="token builtin">eval</span> <span class="token punctuation">(</span><span class="token function">list->cons</span> arr<span class="token punctuation">)</span> env<span class="token punctuation">)</span>
             arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">; add</span>
<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">list->cons</span> exp<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">null?</span> exp<span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'quote</span> <span class="token punctuation">'</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cons</span>
                <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'quote</span> <span class="token punctuation">(</span><span class="token builtin">car</span> exp<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token function">list->cons</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> exp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>代码如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"4.33_helper.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> x y<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">m</span> x y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">car</span> z<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">z</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">p q</span><span class="token punctuation">)</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> z<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token function">z</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">p q</span><span class="token punctuation">)</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token punctuation">(</span><span class="token keyword">define</span> a <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
a

<span class="token punctuation">(</span><span class="token builtin">car</span> a<span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token builtin">car</span> <span class="token punctuation">'</span><span class="token punctuation">(</span>a b c<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>测试结果如下：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; L-Eval input:
a
;;; L-Eval value:
(compound-procedure (m) ((m x y)) &lt;procedure-env&gt;)

;;; L-Eval input:
(car a)
;;; L-Eval value:
1

;;; L-Eval input:
(cons 1 2)
;;; L-Eval value:
(compound-procedure (m) ((m x y)) &lt;procedure-env&gt;)

;;; L-Eval input:
(car &#39;(a b c))
;;; L-Eval value:
a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-34-p286"><a href="#4-34-p286" class="headerlink" title="4.34(p286)"></a>4.34(p286)</h4><p>需要添加一些primitive过程，内容如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">display-cons</span> object<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> <span class="token string">"(cons "</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> <span class="token punctuation">(</span><span class="token function">lazy-car</span> object<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> <span class="token string">" "</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> <span class="token punctuation">(</span><span class="token function">lazy-cdr</span> object<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> <span class="token string">")"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">user-print</span> object<span class="token punctuation">)</span>
    <span class="token comment">; add</span>
    <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">tagged-list?</span> object <span class="token symbol">'cons</span><span class="token punctuation">)</span> 
           <span class="token punctuation">(</span><span class="token function">display-cons</span> object<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">compound-procedure?</span> object<span class="token punctuation">)</span> 
           <span class="token punctuation">(</span><span class="token function">display</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'compound-procedure</span>
                    <span class="token punctuation">(</span><span class="token function">procedure-parameters</span> object<span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token function">procedure-body</span> object<span class="token punctuation">)</span>
                    <span class="token symbol">'&lt;procedure-env></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">display</span> object<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">lazy-cons</span> x y<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cons</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">m</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">m</span> x y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">lazy-car</span> z<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">cadr</span> z<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">p q</span><span class="token punctuation">)</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">lazy-cdr</span> z<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">cadr</span> z<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token keyword">lambda</span> <span class="token punctuation">(</span><span class="token lambda-parameter">p q</span><span class="token punctuation">)</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">initial-env</span>
         <span class="token punctuation">(</span><span class="token function">extend-environment</span> <span class="token punctuation">(</span><span class="token function">primitive-procedure-names</span><span class="token punctuation">)</span>
                             <span class="token punctuation">(</span><span class="token function">primitive-procedure-objects</span><span class="token punctuation">)</span>
                             the-empty-environment<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">define-variable!</span> <span class="token symbol">'true</span> true initial-env<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">define-variable!</span> <span class="token symbol">'false</span> false initial-env<span class="token punctuation">)</span>
    <span class="token comment">; add</span>
    <span class="token punctuation">(</span><span class="token function">define-variable!</span> <span class="token symbol">'lazy-cons</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'primitive</span> lazy-cons<span class="token punctuation">)</span> initial-env<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">define-variable!</span> <span class="token symbol">'lazy-car</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'primitive</span> lazy-car<span class="token punctuation">)</span> initial-env<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">define-variable!</span> <span class="token symbol">'lazy-cdr</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'primitive</span> lazy-cdr<span class="token punctuation">)</span> initial-env<span class="token punctuation">)</span>
    initial-env<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>测试代码：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token comment">; test</span>
<span class="token punctuation">(</span><span class="token keyword">define</span> a <span class="token punctuation">(</span><span class="token function">lazy-cons</span> <span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> b <span class="token punctuation">(</span><span class="token function">lazy-cons</span> <span class="token number">3</span> a<span class="token punctuation">)</span><span class="token punctuation">)</span>

a
b<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; L-Eval input:
a
;;; L-Eval value:
(cons 1 2)

;;; L-Eval input:
b
;;; L-Eval value:
(cons 3 (cons #[compound-procedure 13]))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-35-p290"><a href="#4-35-p290" class="headerlink" title="4.35(p290)"></a>4.35(p290)</h4><p>代码如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> low high<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">>=</span> high low<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">amb</span> low <span class="token punctuation">(</span><span class="token function">an-integer-between</span> <span class="token punctuation">(</span><span class="token operator">+</span> low <span class="token number">1</span><span class="token punctuation">)</span> high<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">a-pythagorean-triple-between</span> low high<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">i</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> low high<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">j</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> i high<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">k</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> j high<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span> i i<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span> j j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span> k k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token builtin">list</span> i j k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">a-pythagorean-triple-between</span> <span class="token number">2</span> <span class="token number">10</span><span class="token punctuation">)</span>
try-again

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">(a-pythagorean-triple-between 2 10)
;;; Starting a new problem 
;;; Amb-Eval value:
(3 4 5)

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
(6 8 10)

;;; Amb-Eval input:
try-again
End of input stream reached.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-36-p290"><a href="#4-36-p290" class="headerlink" title="4.36(p290)"></a>4.36(p290)</h4><p>如果直接换成</p>
<pre class="line-numbers language-none"><code class="language-none">an-integer-starting-from<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>那么最先循环的是$k$，会产生如下结果：</p>
<pre class="line-numbers language-none"><code class="language-none">(1 1 1)
(1 1 2)
(1 1 3)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>正确的方式如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> low high<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">>=</span> high low<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">amb</span> low <span class="token punctuation">(</span><span class="token function">an-integer-between</span> <span class="token punctuation">(</span><span class="token operator">+</span> low <span class="token number">1</span><span class="token punctuation">)</span> high<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">an-integer-starting-from</span> n<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">amb</span> n <span class="token punctuation">(</span><span class="token function">an-integer-starting-from</span> <span class="token punctuation">(</span><span class="token operator">+</span> n <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">; (define (a-pythagorean-triple)</span>
<span class="token comment">;     (let ((i (an-integer-starting-from 1)))</span>
<span class="token comment">;         (let ((j (an-integer-starting-from i)))</span>
<span class="token comment">;         (let ((k (an-integer-starting-from j)))</span>
<span class="token comment">;             (display i)</span>
<span class="token comment">;             (display " ")</span>
<span class="token comment">;             (display j)</span>
<span class="token comment">;             (display " ")</span>
<span class="token comment">;             (display k)</span>
<span class="token comment">;             (newline)</span>
<span class="token comment">;             (require (= (+ (* i i) (* j j)) (* k k)))</span>
<span class="token comment">;             (list i j k)))))</span>
<span class="token comment">; ; 会先循环k, 得到(1 1 1), (1 1 2)</span>
<span class="token comment">; (a-pythagorean-triple)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">a-pythagorean-triple-v1</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">k</span> <span class="token punctuation">(</span><span class="token function">an-integer-starting-from</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">j</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> <span class="token number">1</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">i</span> <span class="token punctuation">(</span><span class="token function">an-integer-between</span> <span class="token number">1</span> j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token punctuation">(</span><span class="token operator">*</span> i i<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span> j j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">*</span> k k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token builtin">list</span> i j k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">a-pythagorean-triple-v1</span><span class="token punctuation">)</span>

try-again

try-again

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Amb-Eval value:
(3 4 5)

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
(6 8 10)

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
(5 12 13)

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
(9 12 15)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-37-p290"><a href="#4-37-p290" class="headerlink" title="4.37(p290)"></a>4.37(p290)</h4><p>效率更高，原因如下：</p>
<ul>
<li>只要枚举i, j</li>
<li>(&gt;= hsq ksq)减少了搜索范围。</li>
</ul>
<h4 id="4-38-p291"><a href="#4-38-p291" class="headerlink" title="4.38(p291)"></a>4.38(p291)</h4><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="http://web.mit.edu/scheme_v9.2/doc/mit-scheme-ref/Machine-Time.html">http://web.mit.edu/scheme_v9.2/doc/mit-scheme-ref/Machine-Time.html</a></p>
<p>原题翻译有误，应该是忽略Smith和Fletcher住在相邻层的约束，原始题目如下：</p>
<p><strong>Exercise 4.38.</strong> Modify the multiple-dwelling procedure to omit the requirement that Smith and Fletcher do not live on adjacent floors. How many solutions are there to this modified puzzle?</p>
<p>代码：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">baker</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">cooper</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">fletcher</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">miller</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">smith</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> baker cooper fletcher miller smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> baker <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> cooper <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">></span> miller cooper<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; (require (not (= (abs (- smith fletcher)) 1)))</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> fletcher cooper<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'baker</span> baker<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cooper</span> cooper<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'fletcher</span> fletcher<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'miller</span> miller<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'smith</span> smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">multiple-dwelling</span><span class="token punctuation">)</span>

try-again

try-again

try-again

try-again

try-again

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Starting a new problem 
;;; Amb-Eval value:
((baker 1) (cooper 2) (fletcher 4) (miller 3) (smith 5))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((baker 1) (cooper 2) (fletcher 4) (miller 5) (smith 3))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((baker 1) (cooper 4) (fletcher 2) (miller 5) (smith 3))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((baker 3) (cooper 2) (fletcher 4) (miller 5) (smith 1))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((baker 3) (cooper 4) (fletcher 2) (miller 5) (smith 1))

;;; Amb-Eval input:
try-again
;;; There are no more values of
(multiple-dwelling)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一共有5个解。</p>
<h4 id="4-39-p291"><a href="#4-39-p291" class="headerlink" title="4.39(p291)"></a>4.39(p291)</h4><p>顺序不会影响结果，但是会影响效率，相关代码如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">; 计算时间</span>
<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-time</span> f n<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">iter</span> i<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">>=</span> n i<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">iter</span> <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> start <span class="token punctuation">(</span><span class="token function">real-time-clock</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">iter</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> end <span class="token punctuation">(</span><span class="token function">real-time-clock</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token operator">/</span> <span class="token punctuation">(</span><span class="token operator">-</span> end start<span class="token punctuation">)</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-v1</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">baker</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">cooper</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">fletcher</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">miller</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">smith</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> baker cooper fletcher miller smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> baker <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> cooper <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">></span> miller cooper<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> smith fletcher<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> fletcher cooper<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'baker</span> baker<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cooper</span> cooper<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'fletcher</span> fletcher<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'miller</span> miller<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'smith</span> smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-v2</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">baker</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">cooper</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">fletcher</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">miller</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">smith</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> baker <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> cooper <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">></span> miller cooper<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> smith fletcher<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> fletcher cooper<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> baker cooper fletcher miller smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'baker</span> baker<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cooper</span> cooper<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'fletcher</span> fletcher<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'miller</span> miller<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'smith</span> smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-time</span> multiple-dwelling-v1 <span class="token number">10.0</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-time</span> multiple-dwelling-v2 <span class="token number">10.0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Amb-Eval input:
; (multiple-dwelling-v1)
(get-time multiple-dwelling-v1 10.0)
;;; Starting a new problem 
;;; Amb-Eval value:
539.5

;;; Amb-Eval input:
(get-time multiple-dwelling-v2 10.0)
;;; Starting a new problem 
;;; Amb-Eval value:
695.6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-40-p291"><a href="#4-40-p291" class="headerlink" title="4.40(p291)"></a>4.40(p291)</h4><p>代码：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-time</span> f n<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">iter</span> i<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">>=</span> n i<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">iter</span> <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> start <span class="token punctuation">(</span><span class="token function">real-time-clock</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">display</span> n<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">iter</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> end <span class="token punctuation">(</span><span class="token function">real-time-clock</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token operator">/</span> <span class="token punctuation">(</span><span class="token operator">-</span> end start<span class="token punctuation">)</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">fletcher</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> fletcher <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">cooper</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> cooper <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> fletcher cooper<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">miller</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token operator">></span> miller cooper<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">smith</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> smith fletcher<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">baker</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> baker <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">(</span><span class="token function">require</span>
                                    <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> baker cooper fletcher miller smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'baker</span> baker<span class="token punctuation">)</span>
                                        <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cooper</span> cooper<span class="token punctuation">)</span>
                                        <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'fletcher</span> fletcher<span class="token punctuation">)</span>
                                        <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'miller</span> miller<span class="token punctuation">)</span>
                                        <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'smith</span> smith<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-time</span> multiple-dwelling <span class="token number">10.0</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Amb-Eval input:
(get-time multiple-dwelling 10.0)
;;; Starting a new problem 10.
;;; Amb-Eval value:
71.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-41-p291"><a href="#4-41-p291" class="headerlink" title="4.41(p291)"></a>4.41(p291)</h4><p>代码：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> x<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">and</span> <span class="token punctuation">(</span><span class="token operator">&lt;=</span> x <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">>=</span> x <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
     <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
           <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
           <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
           <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">judge</span> b c f m s<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">and</span> 
        <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> b c f m s<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> b <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> c <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> f <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> f <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token operator">></span> m c<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token builtin">not</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> f c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> res <span class="token punctuation">'</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; i表示当前处理的元素</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m s i<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">and</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> b<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> c<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> f<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> m<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-range</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">judge</span> b c f m s<span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token keyword">set!</span> res <span class="token punctuation">(</span><span class="token builtin">append</span> res 
                            <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'baker</span> b<span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'cooper</span> c<span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'fletcher</span> f<span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'miller</span> m<span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'smith</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> i <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> <span class="token punctuation">(</span><span class="token operator">+</span> b <span class="token number">1</span><span class="token punctuation">)</span> c f m s i<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m s <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                      <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> i <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b <span class="token punctuation">(</span><span class="token operator">+</span> c <span class="token number">1</span><span class="token punctuation">)</span> f m s i<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m s <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                      <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> i <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c <span class="token punctuation">(</span><span class="token operator">+</span> f <span class="token number">1</span><span class="token punctuation">)</span> m s i<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m s <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                      <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> i <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f <span class="token punctuation">(</span><span class="token operator">+</span> m <span class="token number">1</span><span class="token punctuation">)</span> s i<span class="token punctuation">)</span>
                               <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m s <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                      <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> b c f m <span class="token punctuation">(</span><span class="token operator">+</span> s <span class="token number">1</span><span class="token punctuation">)</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">multiple-dwelling-iter</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span> <span class="token number">1</span><span class="token punctuation">)</span>
    res<span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">multiple-dwelling</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">1 ]&#x3D;&gt; (multiple-dwelling)
;Value 13: (((baker 3) (cooper 4) (fletcher 2) (miller 5) (smith 1)) ((baker 3) (cooper 2) (fletcher 4) (miller 5) (smith 1)) ((baker 1) (cooper 4) (fletcher 2) (miller 5) (smith 3)) ((baker 1) (cooper 2) (fletcher 4) (miller 5) (smith 3)) ((baker 1) (cooper 2) (fletcher 4) (miller 3) (smith 5)))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="4-42-p292"><a href="#4-42-p292" class="headerlink" title="4.42(p292)"></a>4.42(p292)</h4><p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-28.html#%_sec_4.3.2">https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-28.html#%_sec_4.3.2</a></p>
<p><a target="_blank" rel="noopener" href="http://community.schemewiki.org/?sicp-ex-4.42">http://community.schemewiki.org/?sicp-ex-4.42</a></p>
<p>注意如果在primitive-procedures中添加如下内容会报错：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'or</span> or<span class="token punctuation">)</span>
<span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'and</span> and<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>解决方法是使用if来代替or和and，特别的，这里利用if定义了xor，代码如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">xor</span> a b<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> a
        <span class="token punctuation">(</span><span class="token builtin">not</span> b<span class="token punctuation">)</span>
        b<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-rank</span><span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Betty</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ethel</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Joan</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Kitty</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Mary</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Betty Ethel Joan Kitty Mary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">xor</span> <span class="token punctuation">(</span><span class="token operator">=</span> Kitty <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">=</span> Betty <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">xor</span> <span class="token punctuation">(</span><span class="token operator">=</span> Ethel <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">=</span> Joan <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">xor</span> <span class="token punctuation">(</span><span class="token operator">=</span> Joan <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">=</span> Ethel <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">xor</span> <span class="token punctuation">(</span><span class="token operator">=</span> Kitty <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">=</span> Mary <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">xor</span> <span class="token punctuation">(</span><span class="token operator">=</span> Mary <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">=</span> Betty <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Betty</span> Betty<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ethel</span> Ethel<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Joan</span> Joan<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Kitty</span> Kitty<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Mary</span> Mary<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-rank</span><span class="token punctuation">)</span>

try-again

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-43-p292"><a href="#4-43-p292" class="headerlink" title="4.43(p292)"></a>4.43(p292)</h4><p>名称对应关系：</p>
<pre class="line-numbers language-none"><code class="language-none">; daughter
Mary -&gt; Ma
Gabrielle -&gt; Ga
Lorna -&gt; Lo
Rosalind -&gt; Ro
Melissa -&gt; Me

; father
Mr. Moore -&gt; Mo
Sir Barnacle -&gt; Ba
Mr. Hall -&gt; Ha
Colonel Downing -&gt; Co
Dr. Parker -&gt; Pa<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>为了求解该问题，分别定义了daughter-&gt;father以及father-&gt;daughter，代码如下：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">member</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">and</span> p1 p2<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> p1
        p2
        false<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">pair-eq?</span> p1 p2<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">and</span> <span class="token punctuation">(</span><span class="token builtin">eq?</span> <span class="token punctuation">(</span><span class="token builtin">car</span> p1<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">car</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span>
         <span class="token punctuation">(</span><span class="token builtin">eq?</span> <span class="token punctuation">(</span><span class="token builtin">cadr</span> p1<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cadr</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">contain?</span> pair pairs<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> pairs<span class="token punctuation">)</span> false<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">pair-eq?</span> <span class="token punctuation">(</span><span class="token builtin">car</span> pairs<span class="token punctuation">)</span> pair<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">contain?</span> pair <span class="token punctuation">(</span><span class="token builtin">cdr</span> pairs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-answer-v1</span><span class="token punctuation">)</span>
        <span class="token comment">; daughter -> father</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Ma</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Mo</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ga</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Lo</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ro</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Me</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ba</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">; father -> daughter</span>
        <span class="token punctuation">(</span><span class="token function">Mo</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ma</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ba</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Me</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ha</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Co</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Pa</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">; (father, daughter)</span>
        <span class="token punctuation">(</span><span class="token function">pairs</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ba</span> <span class="token symbol">'Ga</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Lo</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Co</span> <span class="token symbol">'Me</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Ga Lo Ro<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Ha Co Pa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">contain?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Ga Pa<span class="token punctuation">)</span> pairs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; (father, daughter)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Mo</span> Mo<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ba</span> Ba<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ha</span> Ha<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Co</span> Co<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Pa</span> Pa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-answer-v1</span><span class="token punctuation">)</span>

try-again

try-again

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-answer-v2</span><span class="token punctuation">)</span>
        <span class="token comment">; daughter -> father</span>
  <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">Ma</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ga</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Lo</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ro</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Co</span> <span class="token symbol">'Pa</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Me</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ba</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">; father -> daughter</span>
        <span class="token punctuation">(</span><span class="token function">Mo</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ma</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ba</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Me</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Ha</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ma</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Co</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ma</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token function">Pa</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token symbol">'Ma</span> <span class="token symbol">'Ga</span> <span class="token symbol">'Lo</span> <span class="token symbol">'Ro</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token comment">; (father, daughter)</span>
        <span class="token punctuation">(</span><span class="token function">pairs</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ba</span> <span class="token symbol">'Ga</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Mo</span> <span class="token symbol">'Lo</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ha</span> <span class="token symbol">'Ro</span><span class="token punctuation">)</span>
                     <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Co</span> <span class="token symbol">'Me</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Ma Ga Lo Ro<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span>
     <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Mo Ha Co Pa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">contain?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> Ga Pa<span class="token punctuation">)</span> pairs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; (father, daughter)</span>
    <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Mo</span> Mo<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ba</span> Ba<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Ha</span> Ha<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Co</span> Co<span class="token punctuation">)</span>
          <span class="token punctuation">(</span><span class="token builtin">list</span> <span class="token symbol">'Pa</span> Pa<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">get-answer-v2</span><span class="token punctuation">)</span>

try-again

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Amb-Eval input:
(get-answer-v1)
;;; Starting a new problem 
;;; Amb-Eval value:
((mo ma) (ba me) (ha ga) (co lo) (pa ro))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((mo ma) (ba me) (ha lo) (co ga) (pa ro))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((mo ma) (ba me) (ha ga) (co lo) (pa ro))

;;; Amb-Eval input:
(get-answer-v2)
;;; Starting a new problem 
;;; Amb-Eval value:
((mo ma) (ba me) (ha ga) (co lo) (pa ro))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((mo ma) (ba me) (ha lo) (co ga) (pa ro))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="4-44-p292"><a href="#4-44-p292" class="headerlink" title="4.44(p292)"></a>4.44(p292)</h4><p>代码：</p>
<pre class="line-numbers language-scheme" data-language="scheme"><code class="language-scheme"><span class="token punctuation">(</span><span class="token function">load</span> <span class="token string">"ch4-ambeval.scm"</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> the-global-environment <span class="token punctuation">(</span><span class="token function">setup-environment</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">driver-loop</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">require</span> p<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">not</span> p<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">amb</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">and</span> p1 p2<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> p1
        p2
        false<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token builtin">or</span> p1 p2<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">if</span> p1
        true
        p2<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">arr-eq?</span> a1 a2<span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token builtin">or</span> <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">car</span> a1<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">car</span> a2<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> a1<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> a2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> items<span class="token punctuation">)</span>
  <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> items<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">null?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> true<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">arr-eq?</span> <span class="token punctuation">(</span><span class="token builtin">car</span> items<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">cadr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">else</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">pred</span> items<span class="token punctuation">)</span>
    <span class="token comment">; 获得长度</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-len</span> arr<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">null?</span> arr<span class="token punctuation">)</span>
            <span class="token number">0</span>
            <span class="token punctuation">(</span><span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">(</span><span class="token function">get-len</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; 获得元素</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">get-item</span> arr k<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">=</span> k <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token builtin">car</span> arr<span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">get-item</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> arr<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">-</span> k <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token punctuation">(</span><span class="token keyword">define</span> n <span class="token punctuation">(</span><span class="token function">get-len</span> items<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; 判断两个元素是否满足条件</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">judge-pair</span> p1 p2<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a1</span> <span class="token punctuation">(</span><span class="token builtin">car</span> p1<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token function">a2</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> p1<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token function">b1</span> <span class="token punctuation">(</span><span class="token builtin">car</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token function">b2</span> <span class="token punctuation">(</span><span class="token builtin">cdr</span> p2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
             <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> a1 b1<span class="token punctuation">)</span> false<span class="token punctuation">)</span>
                   <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> a2 b2<span class="token punctuation">)</span> false<span class="token punctuation">)</span>
                   <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> a1 b1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">abs</span> <span class="token punctuation">(</span><span class="token operator">-</span> a2 b2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> false<span class="token punctuation">)</span>
                   <span class="token punctuation">(</span><span class="token keyword">else</span> true<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; 判断item是否满足条件</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">judge-iter</span> item j<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">></span> j n<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">judge-pair</span> item <span class="token punctuation">(</span><span class="token function">get-item</span> items j<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-iter</span> item <span class="token punctuation">(</span><span class="token operator">+</span> j <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token keyword">else</span> false<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">; 判断从第i个元素开始是否满足条件</span>
    <span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">judge-loop</span> i<span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">cond</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">></span> i n<span class="token punctuation">)</span> true<span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">judge-iter</span> <span class="token punctuation">(</span><span class="token function">get-item</span> items i<span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token function">judge-loop</span> <span class="token punctuation">(</span><span class="token operator">+</span> i <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
              <span class="token punctuation">(</span><span class="token keyword">else</span> false<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token function">judge-loop</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token keyword">define</span> <span class="token punctuation">(</span><span class="token function">8-queen-v1</span><span class="token punctuation">)</span>
    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a1</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">1</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a2</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">2</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a3</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">3</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a4</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">4</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a5</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">5</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a6</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">6</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a7</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">7</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6 a7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6 a7<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">a8</span> <span class="token punctuation">(</span><span class="token builtin">cons</span> <span class="token number">8</span> <span class="token punctuation">(</span><span class="token function">amb</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">distinct?</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6 a7 a8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token function">require</span> <span class="token punctuation">(</span><span class="token function">pred</span> <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6 a7 a8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                                    <span class="token punctuation">(</span><span class="token builtin">list</span> a1 a2 a3 a4 a5 a6 a7 a8<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token punctuation">(</span><span class="token function">8-queen-v1</span><span class="token punctuation">)</span>

try-again<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>实验结果：</p>
<pre class="line-numbers language-none"><code class="language-none">;;; Starting a new problem 
;;; Amb-Eval value:
((1 . 1) (2 . 5) (3 . 8) (4 . 6) (5 . 3) (6 . 7) (7 . 2) (8 . 4))

;;; Amb-Eval input:
try-again
;;; Amb-Eval value:
((1 . 1) (2 . 6) (3 . 8) (4 . 3) (5 . 7) (6 . 4) (7 . 2) (8 . 5))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Doraemonzzz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.doraemonzzz.com/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/">http://www.doraemonzzz.com/2021/06/21/2021-6-21-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A(SICP)-%E7%AC%AC4%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90-Part4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.doraemonzzz.com" target="_blank">Doraemonzzz</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E8%A7%A3%E9%87%8A/">计算机程序的构造和解释</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/22/2021-6-22-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E2%80%94%E2%80%94%E8%87%AA%E9%A1%B6%E5%90%91%E4%B8%8B%E6%96%B9%E6%B3%95%EF%BC%88%E7%AC%AC%E4%B8%83%E7%89%88%EF%BC%89Socket-Programming-Assignment-1WebServer/"><img class="prev-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机网络——自顶向下方法（第七版）Socket Programming Assignment 1:WebServer</div></div></a></div><div class="next-post pull-right"><a href="/2021/06/19/2021-6-19-Hexo%E5%8D%9A%E5%AE%A2%E4%B8%8D%E8%92%9C%E5%AD%90%E9%98%85%E8%AF%BB%E6%AC%A1%E6%95%B0%E8%BF%81%E7%A7%BB%E8%87%B3Leancloud/"><img class="next-cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hexo博客不蒜子阅读次数迁移至Leancloud</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/04/13/2021-4-13-计算机程序的构造和解释(SICP)环境配置(续)/" title="计算机程序的构造和解释(SICP)环境配置(wsl2 + vscode + mit scheme)"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-13</div><div class="title">计算机程序的构造和解释(SICP)环境配置(wsl2 + vscode + mit scheme)</div></div></a></div><div><a href="/2021/04/20/2021-4-20-计算机程序的构造和解释(SICP)-第3章-习题解析-Part6/" title="计算机程序的构造和解释(SICP) 第3章 习题解析 Part6"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-20</div><div class="title">计算机程序的构造和解释(SICP) 第3章 习题解析 Part6</div></div></a></div><div><a href="/2021/04/24/2021-4-24-计算机程序的构造和解释(SICP)-第3章-习题解析-Part7/" title="计算机程序的构造和解释(SICP) 第3章 习题解析 Part7"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-24</div><div class="title">计算机程序的构造和解释(SICP) 第3章 习题解析 Part7</div></div></a></div><div><a href="/2021/05/17/2021-5-17-计算机程序的构造和解释(SICP)-第4章-习题解析-Part1/" title="计算机程序的构造和解释(SICP) 第4章 习题解析 Part1"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-17</div><div class="title">计算机程序的构造和解释(SICP) 第4章 习题解析 Part1</div></div></a></div><div><a href="/2021/05/04/2021-5-4-计算机程序的构造和解释(SICP)-第3章-习题解析-Part8/" title="计算机程序的构造和解释(SICP) 第3章 习题解析 Part8"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-04</div><div class="title">计算机程序的构造和解释(SICP) 第3章 习题解析 Part8</div></div></a></div><div><a href="/2021/06/14/2021-6-14-计算机程序的构造和解释(SICP)-第4章-习题解析-Part3/" title="计算机程序的构造和解释(SICP) 第4章 习题解析 Part3"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-14</div><div class="title">计算机程序的构造和解释(SICP) 第4章 习题解析 Part3</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Livere</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="lv-container" data-id="city" data-uid="MTAyMC8zNDcxOS8xMTI1Ng=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src= "/img/loading.gif" data-lazy-src="https://github.com/Doraemonzzz/md-photo/blob/master/%E5%A4%B4%E5%83%8F.jpg?raw=true" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Doraemonzzz</div><div class="author-info__description">个人博客，主要记录有关机器学习，数学以及计算机科学的笔记</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">665</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">68</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Doraemonzzz"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Doraemonzzz" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/doraemon_zzz@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://space.bilibili.com/291079982" target="_blank" title="Bilibili"><i class="iconfont icon-bilibili"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title=""><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">暂无公告</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-32-p286"><span class="toc-number">1.</span> <span class="toc-text">4.32(p286)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-33-p286"><span class="toc-number">2.</span> <span class="toc-text">4.33(p286)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-34-p286"><span class="toc-number">3.</span> <span class="toc-text">4.34(p286)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-35-p290"><span class="toc-number">4.</span> <span class="toc-text">4.35(p290)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-36-p290"><span class="toc-number">5.</span> <span class="toc-text">4.36(p290)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-37-p290"><span class="toc-number">6.</span> <span class="toc-text">4.37(p290)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-38-p291"><span class="toc-number">7.</span> <span class="toc-text">4.38(p291)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-39-p291"><span class="toc-number">8.</span> <span class="toc-text">4.39(p291)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-40-p291"><span class="toc-number">9.</span> <span class="toc-text">4.40(p291)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-41-p291"><span class="toc-number">10.</span> <span class="toc-text">4.41(p291)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-42-p292"><span class="toc-number">11.</span> <span class="toc-text">4.42(p292)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-43-p292"><span class="toc-number">12.</span> <span class="toc-text">4.43(p292)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-44-p292"><span class="toc-number">13.</span> <span class="toc-text">4.44(p292)</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/09/22/2021-9-22-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC11%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" title="深入理解计算机系统 第11章 习题解析"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入理解计算机系统 第11章 习题解析"/></a><div class="content"><a class="title" href="/2021/09/22/2021-9-22-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC11%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" title="深入理解计算机系统 第11章 习题解析">深入理解计算机系统 第11章 习题解析</a><time datetime="2021-09-22T15:10:00.000Z" title="发表于 2021-09-22 23:10:00">2021-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/22/2021-9-22-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC11%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" title="深入理解计算机系统 第11章 笔记整理"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入理解计算机系统 第11章 笔记整理"/></a><div class="content"><a class="title" href="/2021/09/22/2021-9-22-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC11%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" title="深入理解计算机系统 第11章 笔记整理">深入理解计算机系统 第11章 笔记整理</a><time datetime="2021-09-22T00:55:00.000Z" title="发表于 2021-09-22 08:55:00">2021-09-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/21/2021-9-21-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC10%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" title="深入理解计算机系统 第10章 习题解析"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入理解计算机系统 第10章 习题解析"/></a><div class="content"><a class="title" href="/2021/09/21/2021-9-21-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC10%E7%AB%A0-%E4%B9%A0%E9%A2%98%E8%A7%A3%E6%9E%90/" title="深入理解计算机系统 第10章 习题解析">深入理解计算机系统 第10章 习题解析</a><time datetime="2021-09-21T15:29:00.000Z" title="发表于 2021-09-21 23:29:00">2021-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/21/2021-9-21-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC10%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" title="深入理解计算机系统 第10章 笔记整理"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入理解计算机系统 第10章 笔记整理"/></a><div class="content"><a class="title" href="/2021/09/21/2021-9-21-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC10%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86/" title="深入理解计算机系统 第10章 笔记整理">深入理解计算机系统 第10章 笔记整理</a><time datetime="2021-09-21T09:51:00.000Z" title="发表于 2021-09-21 17:51:00">2021-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/09/16/2021-9-16-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC9%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86-p2/" title="深入理解计算机系统 第9章 笔记整理 p2"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="深入理解计算机系统 第9章 笔记整理 p2"/></a><div class="content"><a class="title" href="/2021/09/16/2021-9-16-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F-%E7%AC%AC9%E7%AB%A0-%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86-p2/" title="深入理解计算机系统 第9章 笔记整理 p2">深入理解计算机系统 第9章 笔记整理 p2</a><time datetime="2021-09-15T16:36:00.000Z" title="发表于 2021-09-16 00:36:00">2021-09-16</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2021 By Doraemonzzz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.25
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'IpnmxCW9CvYWIXbol5QXsegX-MdYXbMMI',
      appKey: 'w57DVCdbxcyB1TYYagMIMJIU',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
      requiredFields: ["nick,mail"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Valine' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>